var Ya=Object.defineProperty;var Ka=(e,n,t)=>n in e?Ya(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var C=(e,n,t)=>(Ka(e,typeof n!="symbol"?n+"":n,t),t);import{s as Pe,a as Ct,x as _e,u as Nt,g as Mt,b as Ut,y as Nn,z as Le,e as Fi,A as Ga,i as Wa,B as $a,r as ja,o as Va,C as qa,n as Ja}from"../chunks/scheduler.BBkzx9Lp.js";import{S as dt,i as ut,y as Pi,m as Oe,z as Hi,a as F,d as S,A as zt,g as X,h as z,k as q,l as ae,B as Qa,u as et,v as tt,w as nt,x as it,q as Xi,n as Yi,e as U,s as j,t as te,c as L,f as V,b as ne,o as H,j as ge,C as oe,D as er,E as tr}from"../chunks/index.jj8V-F3-.js";function Mn(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Lt(e,n){const t={},i={},a={$$scope:1};let r=e.length;for(;r--;){const o=e[r],l=n[r];if(l){for(const h in o)h in l||(i[h]=1);for(const h in l)a[h]||(t[h]=l[h],a[h]=1);e[r]=l}else for(const h in o)a[h]=1}for(const o in i)o in t||(t[o]=void 0);return t}function Ki(e){return typeof e=="object"&&e!==null?e:{}}class nr{constructor(n,t){C(this,"world");C(this,"canvas");C(this,"ctx");C(this,"cameraX",0);C(this,"cameraY",0);C(this,"cameraZoom",32);C(this,"cameraMinZoom",4);C(this,"cameraMaxZoom",64);this.world=n,this.canvas=t;const i=this.canvas.getContext("2d");if(!i)throw new Error("This browser or machine does not support canvas 2d.");this.ctx=i}cameraWidth(){return this.canvas.width/this.cameraZoom}cameraHeight(){return this.canvas.height/this.cameraZoom}cameraTranslate(n,t){this.cameraX-=n/this.cameraZoom,this.cameraY-=t/this.cameraZoom}cameraScale(n){const t=this.cameraX+this.cameraWidth()*.5,i=this.cameraY+this.cameraHeight()*.5;this.cameraZoom*=n,this.canvas.width/this.cameraZoom<this.cameraMinZoom&&(this.cameraZoom=this.canvas.width/this.cameraMinZoom),this.canvas.height/this.cameraZoom<this.cameraMinZoom&&(this.cameraZoom=this.canvas.height/this.cameraMinZoom),this.canvas.width/this.cameraZoom>this.cameraMaxZoom&&(this.cameraZoom=this.canvas.width/this.cameraMaxZoom),this.canvas.height/this.cameraZoom>this.cameraMaxZoom&&(this.cameraZoom=this.canvas.height/this.cameraMaxZoom);const a=this.cameraX+this.cameraWidth()*.5,r=this.cameraY+this.cameraHeight()*.5;return this.cameraX-=a-t,this.cameraY-=r-i,this.cameraZoom}cameraBounds(n=0){return{minX:Math.floor(this.cameraX-n),minY:Math.floor(this.cameraY-n),maxX:Math.ceil(this.cameraX+this.cameraWidth()+n),maxY:Math.ceil(this.cameraY+this.cameraHeight()+n)}}cameraPos(n,t){return{x:Math.floor(n/this.cameraZoom+this.cameraX),y:Math.floor(t/this.cameraZoom+this.cameraY)}}renderWorld(){this.ctx.imageSmoothingEnabled=!1,this.ctx.scale(this.cameraZoom,this.cameraZoom),this.ctx.translate(-this.cameraX,-this.cameraY);const n=this.cameraBounds(1);for(let t=n.minX;t<n.maxX;t++)for(let i=n.minY;i<n.maxY;i++)this.ctx.save(),this.ctx.translate(t,i),this.ctx.scale(1.01,1.01),this.world.getTile(t,i).render(this.ctx),this.ctx.restore();this.ctx.imageSmoothingEnabled=!0}render(){this.ctx.reset(),this.ctx.fillStyle="purple",this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.renderWorld()}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const ir=4,Un=0,Ln=1,ar=2;function He(e){let n=e.length;for(;--n>=0;)e[n]=0}const rr=0,Gi=1,lr=2,or=3,sr=258,wn=29,bt=256,at=bt+1+wn,Me=30,gn=19,Wi=2*at+1,xe=15,Xt=16,fr=7,mn=256,$i=16,ji=17,Vi=18,rn=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),St=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),cr=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),qi=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),hr=512,ue=new Array((at+2)*2);He(ue);const qe=new Array(Me*2);He(qe);const rt=new Array(hr);He(rt);const lt=new Array(sr-or+1);He(lt);const pn=new Array(wn);He(pn);const Dt=new Array(Me);He(Dt);function Yt(e,n,t,i,a){this.static_tree=e,this.extra_bits=n,this.extra_base=t,this.elems=i,this.max_length=a,this.has_stree=e&&e.length}let Ji,Qi,ea;function Kt(e,n){this.dyn_tree=e,this.max_code=0,this.stat_desc=n}const ta=e=>e<256?rt[e]:rt[256+(e>>>7)],ot=(e,n)=>{e.pending_buf[e.pending++]=n&255,e.pending_buf[e.pending++]=n>>>8&255},Q=(e,n,t)=>{e.bi_valid>Xt-t?(e.bi_buf|=n<<e.bi_valid&65535,ot(e,e.bi_buf),e.bi_buf=n>>Xt-e.bi_valid,e.bi_valid+=t-Xt):(e.bi_buf|=n<<e.bi_valid&65535,e.bi_valid+=t)},fe=(e,n,t)=>{Q(e,t[n*2],t[n*2+1])},na=(e,n)=>{let t=0;do t|=e&1,e>>>=1,t<<=1;while(--n>0);return t>>>1},_r=e=>{e.bi_valid===16?(ot(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},dr=(e,n)=>{const t=n.dyn_tree,i=n.max_code,a=n.stat_desc.static_tree,r=n.stat_desc.has_stree,o=n.stat_desc.extra_bits,l=n.stat_desc.extra_base,h=n.stat_desc.max_length;let s,f,w,_,c,d,k=0;for(_=0;_<=xe;_++)e.bl_count[_]=0;for(t[e.heap[e.heap_max]*2+1]=0,s=e.heap_max+1;s<Wi;s++)f=e.heap[s],_=t[t[f*2+1]*2+1]+1,_>h&&(_=h,k++),t[f*2+1]=_,!(f>i)&&(e.bl_count[_]++,c=0,f>=l&&(c=o[f-l]),d=t[f*2],e.opt_len+=d*(_+c),r&&(e.static_len+=d*(a[f*2+1]+c)));if(k!==0){do{for(_=h-1;e.bl_count[_]===0;)_--;e.bl_count[_]--,e.bl_count[_+1]+=2,e.bl_count[h]--,k-=2}while(k>0);for(_=h;_!==0;_--)for(f=e.bl_count[_];f!==0;)w=e.heap[--s],!(w>i)&&(t[w*2+1]!==_&&(e.opt_len+=(_-t[w*2+1])*t[w*2],t[w*2+1]=_),f--)}},ia=(e,n,t)=>{const i=new Array(xe+1);let a=0,r,o;for(r=1;r<=xe;r++)a=a+t[r-1]<<1,i[r]=a;for(o=0;o<=n;o++){let l=e[o*2+1];l!==0&&(e[o*2]=na(i[l]++,l))}},ur=()=>{let e,n,t,i,a;const r=new Array(xe+1);for(t=0,i=0;i<wn-1;i++)for(pn[i]=t,e=0;e<1<<rn[i];e++)lt[t++]=i;for(lt[t-1]=i,a=0,i=0;i<16;i++)for(Dt[i]=a,e=0;e<1<<St[i];e++)rt[a++]=i;for(a>>=7;i<Me;i++)for(Dt[i]=a<<7,e=0;e<1<<St[i]-7;e++)rt[256+a++]=i;for(n=0;n<=xe;n++)r[n]=0;for(e=0;e<=143;)ue[e*2+1]=8,e++,r[8]++;for(;e<=255;)ue[e*2+1]=9,e++,r[9]++;for(;e<=279;)ue[e*2+1]=7,e++,r[7]++;for(;e<=287;)ue[e*2+1]=8,e++,r[8]++;for(ia(ue,at+1,r),e=0;e<Me;e++)qe[e*2+1]=5,qe[e*2]=na(e,5);Ji=new Yt(ue,rn,bt+1,at,xe),Qi=new Yt(qe,St,0,Me,xe),ea=new Yt(new Array(0),cr,0,gn,fr)},aa=e=>{let n;for(n=0;n<at;n++)e.dyn_ltree[n*2]=0;for(n=0;n<Me;n++)e.dyn_dtree[n*2]=0;for(n=0;n<gn;n++)e.bl_tree[n*2]=0;e.dyn_ltree[mn*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},ra=e=>{e.bi_valid>8?ot(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},On=(e,n,t,i)=>{const a=n*2,r=t*2;return e[a]<e[r]||e[a]===e[r]&&i[n]<=i[t]},Gt=(e,n,t)=>{const i=e.heap[t];let a=t<<1;for(;a<=e.heap_len&&(a<e.heap_len&&On(n,e.heap[a+1],e.heap[a],e.depth)&&a++,!On(n,i,e.heap[a],e.depth));)e.heap[t]=e.heap[a],t=a,a<<=1;e.heap[t]=i},Bn=(e,n,t)=>{let i,a,r=0,o,l;if(e.sym_next!==0)do i=e.pending_buf[e.sym_buf+r++]&255,i+=(e.pending_buf[e.sym_buf+r++]&255)<<8,a=e.pending_buf[e.sym_buf+r++],i===0?fe(e,a,n):(o=lt[a],fe(e,o+bt+1,n),l=rn[o],l!==0&&(a-=pn[o],Q(e,a,l)),i--,o=ta(i),fe(e,o,t),l=St[o],l!==0&&(i-=Dt[o],Q(e,i,l)));while(r<e.sym_next);fe(e,mn,n)},ln=(e,n)=>{const t=n.dyn_tree,i=n.stat_desc.static_tree,a=n.stat_desc.has_stree,r=n.stat_desc.elems;let o,l,h=-1,s;for(e.heap_len=0,e.heap_max=Wi,o=0;o<r;o++)t[o*2]!==0?(e.heap[++e.heap_len]=h=o,e.depth[o]=0):t[o*2+1]=0;for(;e.heap_len<2;)s=e.heap[++e.heap_len]=h<2?++h:0,t[s*2]=1,e.depth[s]=0,e.opt_len--,a&&(e.static_len-=i[s*2+1]);for(n.max_code=h,o=e.heap_len>>1;o>=1;o--)Gt(e,t,o);s=r;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Gt(e,t,1),l=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=l,t[s*2]=t[o*2]+t[l*2],e.depth[s]=(e.depth[o]>=e.depth[l]?e.depth[o]:e.depth[l])+1,t[o*2+1]=t[l*2+1]=s,e.heap[1]=s++,Gt(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],dr(e,n),ia(t,h,e.bl_count)},Fn=(e,n,t)=>{let i,a=-1,r,o=n[0*2+1],l=0,h=7,s=4;for(o===0&&(h=138,s=3),n[(t+1)*2+1]=65535,i=0;i<=t;i++)r=o,o=n[(i+1)*2+1],!(++l<h&&r===o)&&(l<s?e.bl_tree[r*2]+=l:r!==0?(r!==a&&e.bl_tree[r*2]++,e.bl_tree[$i*2]++):l<=10?e.bl_tree[ji*2]++:e.bl_tree[Vi*2]++,l=0,a=r,o===0?(h=138,s=3):r===o?(h=6,s=3):(h=7,s=4))},Pn=(e,n,t)=>{let i,a=-1,r,o=n[0*2+1],l=0,h=7,s=4;for(o===0&&(h=138,s=3),i=0;i<=t;i++)if(r=o,o=n[(i+1)*2+1],!(++l<h&&r===o)){if(l<s)do fe(e,r,e.bl_tree);while(--l!==0);else r!==0?(r!==a&&(fe(e,r,e.bl_tree),l--),fe(e,$i,e.bl_tree),Q(e,l-3,2)):l<=10?(fe(e,ji,e.bl_tree),Q(e,l-3,3)):(fe(e,Vi,e.bl_tree),Q(e,l-11,7));l=0,a=r,o===0?(h=138,s=3):r===o?(h=6,s=3):(h=7,s=4)}},br=e=>{let n;for(Fn(e,e.dyn_ltree,e.l_desc.max_code),Fn(e,e.dyn_dtree,e.d_desc.max_code),ln(e,e.bl_desc),n=gn-1;n>=3&&e.bl_tree[qi[n]*2+1]===0;n--);return e.opt_len+=3*(n+1)+5+5+4,n},wr=(e,n,t,i)=>{let a;for(Q(e,n-257,5),Q(e,t-1,5),Q(e,i-4,4),a=0;a<i;a++)Q(e,e.bl_tree[qi[a]*2+1],3);Pn(e,e.dyn_ltree,n-1),Pn(e,e.dyn_dtree,t-1)},gr=e=>{let n=4093624447,t;for(t=0;t<=31;t++,n>>>=1)if(n&1&&e.dyn_ltree[t*2]!==0)return Un;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Ln;for(t=32;t<bt;t++)if(e.dyn_ltree[t*2]!==0)return Ln;return Un};let Hn=!1;const mr=e=>{Hn||(ur(),Hn=!0),e.l_desc=new Kt(e.dyn_ltree,Ji),e.d_desc=new Kt(e.dyn_dtree,Qi),e.bl_desc=new Kt(e.bl_tree,ea),e.bi_buf=0,e.bi_valid=0,aa(e)},la=(e,n,t,i)=>{Q(e,(rr<<1)+(i?1:0),3),ra(e),ot(e,t),ot(e,~t),t&&e.pending_buf.set(e.window.subarray(n,n+t),e.pending),e.pending+=t},pr=e=>{Q(e,Gi<<1,3),fe(e,mn,ue),_r(e)},vr=(e,n,t,i)=>{let a,r,o=0;e.level>0?(e.strm.data_type===ar&&(e.strm.data_type=gr(e)),ln(e,e.l_desc),ln(e,e.d_desc),o=br(e),a=e.opt_len+3+7>>>3,r=e.static_len+3+7>>>3,r<=a&&(a=r)):a=r=t+5,t+4<=a&&n!==-1?la(e,n,t,i):e.strategy===ir||r===a?(Q(e,(Gi<<1)+(i?1:0),3),Bn(e,ue,qe)):(Q(e,(lr<<1)+(i?1:0),3),wr(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Bn(e,e.dyn_ltree,e.dyn_dtree)),aa(e),i&&ra(e)},kr=(e,n,t)=>(e.pending_buf[e.sym_buf+e.sym_next++]=n,e.pending_buf[e.sym_buf+e.sym_next++]=n>>8,e.pending_buf[e.sym_buf+e.sym_next++]=t,n===0?e.dyn_ltree[t*2]++:(e.matches++,n--,e.dyn_ltree[(lt[t]+bt+1)*2]++,e.dyn_dtree[ta(n)*2]++),e.sym_next===e.sym_end);var xr=mr,yr=la,Er=vr,Ar=kr,Sr=pr,Tr={_tr_init:xr,_tr_stored_block:yr,_tr_flush_block:Er,_tr_tally:Ar,_tr_align:Sr};const zr=(e,n,t,i)=>{let a=e&65535|0,r=e>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do a=a+n[i++]|0,r=r+a|0;while(--o);a%=65521,r%=65521}return a|r<<16|0};var st=zr;const Dr=()=>{let e,n=[];for(var t=0;t<256;t++){e=t;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;n[t]=e}return n},Rr=new Uint32Array(Dr()),Zr=(e,n,t,i)=>{const a=Rr,r=i+t;e^=-1;for(let o=i;o<r;o++)e=e>>>8^a[(e^n[o])&255];return e^-1};var K=Zr,Se={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},De={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Ir,_tr_stored_block:on,_tr_flush_block:Cr,_tr_tally:pe,_tr_align:Nr}=Tr,{Z_NO_FLUSH:ve,Z_PARTIAL_FLUSH:Mr,Z_FULL_FLUSH:Ur,Z_FINISH:re,Z_BLOCK:Xn,Z_OK:W,Z_STREAM_END:Yn,Z_STREAM_ERROR:ce,Z_DATA_ERROR:Lr,Z_BUF_ERROR:Wt,Z_DEFAULT_COMPRESSION:Or,Z_FILTERED:Br,Z_HUFFMAN_ONLY:vt,Z_RLE:Fr,Z_FIXED:Pr,Z_DEFAULT_STRATEGY:Hr,Z_UNKNOWN:Xr,Z_DEFLATED:Ot}=De,Yr=9,Kr=15,Gr=8,Wr=29,$r=256,sn=$r+1+Wr,jr=30,Vr=19,qr=2*sn+1,Jr=15,I=3,me=258,he=me+I+1,Qr=32,Be=42,vn=57,fn=69,cn=73,hn=91,_n=103,ye=113,$e=666,J=1,Xe=2,Te=3,Ye=4,el=3,Ee=(e,n)=>(e.msg=Se[n],n),Kn=e=>e*2-(e>4?9:0),we=e=>{let n=e.length;for(;--n>=0;)e[n]=0},tl=e=>{let n,t,i,a=e.w_size;n=e.hash_size,i=n;do t=e.head[--i],e.head[i]=t>=a?t-a:0;while(--n);n=a,i=n;do t=e.prev[--i],e.prev[i]=t>=a?t-a:0;while(--n)};let nl=(e,n,t)=>(n<<e.hash_shift^t)&e.hash_mask,ke=nl;const ee=e=>{const n=e.state;let t=n.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(e.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+t),e.next_out),e.next_out+=t,n.pending_out+=t,e.total_out+=t,e.avail_out-=t,n.pending-=t,n.pending===0&&(n.pending_out=0))},ie=(e,n)=>{Cr(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,n),e.block_start=e.strstart,ee(e.strm)},N=(e,n)=>{e.pending_buf[e.pending++]=n},We=(e,n)=>{e.pending_buf[e.pending++]=n>>>8&255,e.pending_buf[e.pending++]=n&255},dn=(e,n,t,i)=>{let a=e.avail_in;return a>i&&(a=i),a===0?0:(e.avail_in-=a,n.set(e.input.subarray(e.next_in,e.next_in+a),t),e.state.wrap===1?e.adler=st(e.adler,n,a,t):e.state.wrap===2&&(e.adler=K(e.adler,n,a,t)),e.next_in+=a,e.total_in+=a,a)},oa=(e,n)=>{let t=e.max_chain_length,i=e.strstart,a,r,o=e.prev_length,l=e.nice_match;const h=e.strstart>e.w_size-he?e.strstart-(e.w_size-he):0,s=e.window,f=e.w_mask,w=e.prev,_=e.strstart+me;let c=s[i+o-1],d=s[i+o];e.prev_length>=e.good_match&&(t>>=2),l>e.lookahead&&(l=e.lookahead);do if(a=n,!(s[a+o]!==d||s[a+o-1]!==c||s[a]!==s[i]||s[++a]!==s[i+1])){i+=2,a++;do;while(s[++i]===s[++a]&&s[++i]===s[++a]&&s[++i]===s[++a]&&s[++i]===s[++a]&&s[++i]===s[++a]&&s[++i]===s[++a]&&s[++i]===s[++a]&&s[++i]===s[++a]&&i<_);if(r=me-(_-i),i=_-me,r>o){if(e.match_start=n,o=r,r>=l)break;c=s[i+o-1],d=s[i+o]}}while((n=w[n&f])>h&&--t!==0);return o<=e.lookahead?o:e.lookahead},Fe=e=>{const n=e.w_size;let t,i,a;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=n+(n-he)&&(e.window.set(e.window.subarray(n,n+n-i),0),e.match_start-=n,e.strstart-=n,e.block_start-=n,e.insert>e.strstart&&(e.insert=e.strstart),tl(e),i+=n),e.strm.avail_in===0)break;if(t=dn(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=t,e.lookahead+e.insert>=I)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=ke(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=ke(e,e.ins_h,e.window[a+I-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<I)););}while(e.lookahead<he&&e.strm.avail_in!==0)},sa=(e,n)=>{let t=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,i,a,r,o=0,l=e.strm.avail_in;do{if(i=65535,r=e.bi_valid+42>>3,e.strm.avail_out<r||(r=e.strm.avail_out-r,a=e.strstart-e.block_start,i>a+e.strm.avail_in&&(i=a+e.strm.avail_in),i>r&&(i=r),i<t&&(i===0&&n!==re||n===ve||i!==a+e.strm.avail_in)))break;o=n===re&&i===a+e.strm.avail_in?1:0,on(e,0,0,o),e.pending_buf[e.pending-4]=i,e.pending_buf[e.pending-3]=i>>8,e.pending_buf[e.pending-2]=~i,e.pending_buf[e.pending-1]=~i>>8,ee(e.strm),a&&(a>i&&(a=i),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+a),e.strm.next_out),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a,e.block_start+=a,i-=a),i&&(dn(e.strm,e.strm.output,e.strm.next_out,i),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i)}while(o===0);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?Ye:n!==ve&&n!==re&&e.strm.avail_in===0&&e.strstart===e.block_start?Xe:(r=e.window_size-e.strstart,e.strm.avail_in>r&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,r+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),r>e.strm.avail_in&&(r=e.strm.avail_in),r&&(dn(e.strm,e.window,e.strstart,r),e.strstart+=r,e.insert+=r>e.w_size-e.insert?e.w_size-e.insert:r),e.high_water<e.strstart&&(e.high_water=e.strstart),r=e.bi_valid+42>>3,r=e.pending_buf_size-r>65535?65535:e.pending_buf_size-r,t=r>e.w_size?e.w_size:r,a=e.strstart-e.block_start,(a>=t||(a||n===re)&&n!==ve&&e.strm.avail_in===0&&a<=r)&&(i=a>r?r:a,o=n===re&&e.strm.avail_in===0&&i===a?1:0,on(e,e.block_start,i,o),e.block_start+=i,ee(e.strm)),o?Te:J)},$t=(e,n)=>{let t,i;for(;;){if(e.lookahead<he){if(Fe(e),e.lookahead<he&&n===ve)return J;if(e.lookahead===0)break}if(t=0,e.lookahead>=I&&(e.ins_h=ke(e,e.ins_h,e.window[e.strstart+I-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-he&&(e.match_length=oa(e,t)),e.match_length>=I)if(i=pe(e,e.strstart-e.match_start,e.match_length-I),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=I){e.match_length--;do e.strstart++,e.ins_h=ke(e,e.ins_h,e.window[e.strstart+I-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=ke(e,e.ins_h,e.window[e.strstart+1]);else i=pe(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(ie(e,!1),e.strm.avail_out===0))return J}return e.insert=e.strstart<I-1?e.strstart:I-1,n===re?(ie(e,!0),e.strm.avail_out===0?Te:Ye):e.sym_next&&(ie(e,!1),e.strm.avail_out===0)?J:Xe},Ce=(e,n)=>{let t,i,a;for(;;){if(e.lookahead<he){if(Fe(e),e.lookahead<he&&n===ve)return J;if(e.lookahead===0)break}if(t=0,e.lookahead>=I&&(e.ins_h=ke(e,e.ins_h,e.window[e.strstart+I-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=I-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-he&&(e.match_length=oa(e,t),e.match_length<=5&&(e.strategy===Br||e.match_length===I&&e.strstart-e.match_start>4096)&&(e.match_length=I-1)),e.prev_length>=I&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-I,i=pe(e,e.strstart-1-e.prev_match,e.prev_length-I),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=a&&(e.ins_h=ke(e,e.ins_h,e.window[e.strstart+I-1]),t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=I-1,e.strstart++,i&&(ie(e,!1),e.strm.avail_out===0))return J}else if(e.match_available){if(i=pe(e,0,e.window[e.strstart-1]),i&&ie(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return J}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=pe(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<I-1?e.strstart:I-1,n===re?(ie(e,!0),e.strm.avail_out===0?Te:Ye):e.sym_next&&(ie(e,!1),e.strm.avail_out===0)?J:Xe},il=(e,n)=>{let t,i,a,r;const o=e.window;for(;;){if(e.lookahead<=me){if(Fe(e),e.lookahead<=me&&n===ve)return J;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=I&&e.strstart>0&&(a=e.strstart-1,i=o[a],i===o[++a]&&i===o[++a]&&i===o[++a])){r=e.strstart+me;do;while(i===o[++a]&&i===o[++a]&&i===o[++a]&&i===o[++a]&&i===o[++a]&&i===o[++a]&&i===o[++a]&&i===o[++a]&&a<r);e.match_length=me-(r-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=I?(t=pe(e,1,e.match_length-I),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=pe(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(ie(e,!1),e.strm.avail_out===0))return J}return e.insert=0,n===re?(ie(e,!0),e.strm.avail_out===0?Te:Ye):e.sym_next&&(ie(e,!1),e.strm.avail_out===0)?J:Xe},al=(e,n)=>{let t;for(;;){if(e.lookahead===0&&(Fe(e),e.lookahead===0)){if(n===ve)return J;break}if(e.match_length=0,t=pe(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(ie(e,!1),e.strm.avail_out===0))return J}return e.insert=0,n===re?(ie(e,!0),e.strm.avail_out===0?Te:Ye):e.sym_next&&(ie(e,!1),e.strm.avail_out===0)?J:Xe};function se(e,n,t,i,a){this.good_length=e,this.max_lazy=n,this.nice_length=t,this.max_chain=i,this.func=a}const je=[new se(0,0,0,0,sa),new se(4,4,8,4,$t),new se(4,5,16,8,$t),new se(4,6,32,32,$t),new se(4,4,16,16,Ce),new se(8,16,32,32,Ce),new se(8,16,128,128,Ce),new se(8,32,128,256,Ce),new se(32,128,258,1024,Ce),new se(32,258,258,4096,Ce)],rl=e=>{e.window_size=2*e.w_size,we(e.head),e.max_lazy_match=je[e.level].max_lazy,e.good_match=je[e.level].good_length,e.nice_match=je[e.level].nice_length,e.max_chain_length=je[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=I-1,e.match_available=0,e.ins_h=0};function ll(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ot,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(qr*2),this.dyn_dtree=new Uint16Array((2*jr+1)*2),this.bl_tree=new Uint16Array((2*Vr+1)*2),we(this.dyn_ltree),we(this.dyn_dtree),we(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Jr+1),this.heap=new Uint16Array(2*sn+1),we(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*sn+1),we(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const wt=e=>{if(!e)return 1;const n=e.state;return!n||n.strm!==e||n.status!==Be&&n.status!==vn&&n.status!==fn&&n.status!==cn&&n.status!==hn&&n.status!==_n&&n.status!==ye&&n.status!==$e?1:0},fa=e=>{if(wt(e))return Ee(e,ce);e.total_in=e.total_out=0,e.data_type=Xr;const n=e.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap===2?vn:n.wrap?Be:ye,e.adler=n.wrap===2?0:1,n.last_flush=-2,Ir(n),W},ca=e=>{const n=fa(e);return n===W&&rl(e.state),n},ol=(e,n)=>wt(e)||e.state.wrap!==2?ce:(e.state.gzhead=n,W),ha=(e,n,t,i,a,r)=>{if(!e)return ce;let o=1;if(n===Or&&(n=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),a<1||a>Yr||t!==Ot||i<8||i>15||n<0||n>9||r<0||r>Pr||i===8&&o!==1)return Ee(e,ce);i===8&&(i=9);const l=new ll;return e.state=l,l.strm=e,l.status=Be,l.wrap=o,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+I-1)/I),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=(l.lit_bufsize-1)*3,l.level=n,l.strategy=r,l.method=t,ca(e)},sl=(e,n)=>ha(e,n,Ot,Kr,Gr,Hr),fl=(e,n)=>{if(wt(e)||n>Xn||n<0)return e?Ee(e,ce):ce;const t=e.state;if(!e.output||e.avail_in!==0&&!e.input||t.status===$e&&n!==re)return Ee(e,e.avail_out===0?Wt:ce);const i=t.last_flush;if(t.last_flush=n,t.pending!==0){if(ee(e),e.avail_out===0)return t.last_flush=-1,W}else if(e.avail_in===0&&Kn(n)<=Kn(i)&&n!==re)return Ee(e,Wt);if(t.status===$e&&e.avail_in!==0)return Ee(e,Wt);if(t.status===Be&&t.wrap===0&&(t.status=ye),t.status===Be){let a=Ot+(t.w_bits-8<<4)<<8,r=-1;if(t.strategy>=vt||t.level<2?r=0:t.level<6?r=1:t.level===6?r=2:r=3,a|=r<<6,t.strstart!==0&&(a|=Qr),a+=31-a%31,We(t,a),t.strstart!==0&&(We(t,e.adler>>>16),We(t,e.adler&65535)),e.adler=1,t.status=ye,ee(e),t.pending!==0)return t.last_flush=-1,W}if(t.status===vn){if(e.adler=0,N(t,31),N(t,139),N(t,8),t.gzhead)N(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),N(t,t.gzhead.time&255),N(t,t.gzhead.time>>8&255),N(t,t.gzhead.time>>16&255),N(t,t.gzhead.time>>24&255),N(t,t.level===9?2:t.strategy>=vt||t.level<2?4:0),N(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(N(t,t.gzhead.extra.length&255),N(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(e.adler=K(e.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=fn;else if(N(t,0),N(t,0),N(t,0),N(t,0),N(t,0),N(t,t.level===9?2:t.strategy>=vt||t.level<2?4:0),N(t,el),t.status=ye,ee(e),t.pending!==0)return t.last_flush=-1,W}if(t.status===fn){if(t.gzhead.extra){let a=t.pending,r=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+r>t.pending_buf_size;){let l=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+l),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>a&&(e.adler=K(e.adler,t.pending_buf,t.pending-a,a)),t.gzindex+=l,ee(e),t.pending!==0)return t.last_flush=-1,W;a=0,r-=l}let o=new Uint8Array(t.gzhead.extra);t.pending_buf.set(o.subarray(t.gzindex,t.gzindex+r),t.pending),t.pending+=r,t.gzhead.hcrc&&t.pending>a&&(e.adler=K(e.adler,t.pending_buf,t.pending-a,a)),t.gzindex=0}t.status=cn}if(t.status===cn){if(t.gzhead.name){let a=t.pending,r;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>a&&(e.adler=K(e.adler,t.pending_buf,t.pending-a,a)),ee(e),t.pending!==0)return t.last_flush=-1,W;a=0}t.gzindex<t.gzhead.name.length?r=t.gzhead.name.charCodeAt(t.gzindex++)&255:r=0,N(t,r)}while(r!==0);t.gzhead.hcrc&&t.pending>a&&(e.adler=K(e.adler,t.pending_buf,t.pending-a,a)),t.gzindex=0}t.status=hn}if(t.status===hn){if(t.gzhead.comment){let a=t.pending,r;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>a&&(e.adler=K(e.adler,t.pending_buf,t.pending-a,a)),ee(e),t.pending!==0)return t.last_flush=-1,W;a=0}t.gzindex<t.gzhead.comment.length?r=t.gzhead.comment.charCodeAt(t.gzindex++)&255:r=0,N(t,r)}while(r!==0);t.gzhead.hcrc&&t.pending>a&&(e.adler=K(e.adler,t.pending_buf,t.pending-a,a))}t.status=_n}if(t.status===_n){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(ee(e),t.pending!==0))return t.last_flush=-1,W;N(t,e.adler&255),N(t,e.adler>>8&255),e.adler=0}if(t.status=ye,ee(e),t.pending!==0)return t.last_flush=-1,W}if(e.avail_in!==0||t.lookahead!==0||n!==ve&&t.status!==$e){let a=t.level===0?sa(t,n):t.strategy===vt?al(t,n):t.strategy===Fr?il(t,n):je[t.level].func(t,n);if((a===Te||a===Ye)&&(t.status=$e),a===J||a===Te)return e.avail_out===0&&(t.last_flush=-1),W;if(a===Xe&&(n===Mr?Nr(t):n!==Xn&&(on(t,0,0,!1),n===Ur&&(we(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),ee(e),e.avail_out===0))return t.last_flush=-1,W}return n!==re?W:t.wrap<=0?Yn:(t.wrap===2?(N(t,e.adler&255),N(t,e.adler>>8&255),N(t,e.adler>>16&255),N(t,e.adler>>24&255),N(t,e.total_in&255),N(t,e.total_in>>8&255),N(t,e.total_in>>16&255),N(t,e.total_in>>24&255)):(We(t,e.adler>>>16),We(t,e.adler&65535)),ee(e),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?W:Yn)},cl=e=>{if(wt(e))return ce;const n=e.state.status;return e.state=null,n===ye?Ee(e,Lr):W},hl=(e,n)=>{let t=n.length;if(wt(e))return ce;const i=e.state,a=i.wrap;if(a===2||a===1&&i.status!==Be||i.lookahead)return ce;if(a===1&&(e.adler=st(e.adler,n,t,0)),i.wrap=0,t>=i.w_size){a===0&&(we(i.head),i.strstart=0,i.block_start=0,i.insert=0);let h=new Uint8Array(i.w_size);h.set(n.subarray(t-i.w_size,t),0),n=h,t=i.w_size}const r=e.avail_in,o=e.next_in,l=e.input;for(e.avail_in=t,e.next_in=0,e.input=n,Fe(i);i.lookahead>=I;){let h=i.strstart,s=i.lookahead-(I-1);do i.ins_h=ke(i,i.ins_h,i.window[h+I-1]),i.prev[h&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=h,h++;while(--s);i.strstart=h,i.lookahead=I-1,Fe(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=I-1,i.match_available=0,e.next_in=o,e.input=l,e.avail_in=r,i.wrap=a,W};var _l=sl,dl=ha,ul=ca,bl=fa,wl=ol,gl=fl,ml=cl,pl=hl,vl="pako deflate (from Nodeca project)",Je={deflateInit:_l,deflateInit2:dl,deflateReset:ul,deflateResetKeep:bl,deflateSetHeader:wl,deflate:gl,deflateEnd:ml,deflateSetDictionary:pl,deflateInfo:vl};const kl=(e,n)=>Object.prototype.hasOwnProperty.call(e,n);var xl=function(e){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const t=n.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const i in t)kl(t,i)&&(e[i]=t[i])}}return e},yl=e=>{let n=0;for(let i=0,a=e.length;i<a;i++)n+=e[i].length;const t=new Uint8Array(n);for(let i=0,a=0,r=e.length;i<r;i++){let o=e[i];t.set(o,a),a+=o.length}return t},Bt={assign:xl,flattenChunks:yl};let _a=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{_a=!1}const ft=new Uint8Array(256);for(let e=0;e<256;e++)ft[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;ft[254]=ft[254]=1;var El=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let n,t,i,a,r,o=e.length,l=0;for(a=0;a<o;a++)t=e.charCodeAt(a),(t&64512)===55296&&a+1<o&&(i=e.charCodeAt(a+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),a++)),l+=t<128?1:t<2048?2:t<65536?3:4;for(n=new Uint8Array(l),r=0,a=0;r<l;a++)t=e.charCodeAt(a),(t&64512)===55296&&a+1<o&&(i=e.charCodeAt(a+1),(i&64512)===56320&&(t=65536+(t-55296<<10)+(i-56320),a++)),t<128?n[r++]=t:t<2048?(n[r++]=192|t>>>6,n[r++]=128|t&63):t<65536?(n[r++]=224|t>>>12,n[r++]=128|t>>>6&63,n[r++]=128|t&63):(n[r++]=240|t>>>18,n[r++]=128|t>>>12&63,n[r++]=128|t>>>6&63,n[r++]=128|t&63);return n};const Al=(e,n)=>{if(n<65534&&e.subarray&&_a)return String.fromCharCode.apply(null,e.length===n?e:e.subarray(0,n));let t="";for(let i=0;i<n;i++)t+=String.fromCharCode(e[i]);return t};var Sl=(e,n)=>{const t=n||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,n));let i,a;const r=new Array(t*2);for(a=0,i=0;i<t;){let o=e[i++];if(o<128){r[a++]=o;continue}let l=ft[o];if(l>4){r[a++]=65533,i+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&i<t;)o=o<<6|e[i++]&63,l--;if(l>1){r[a++]=65533;continue}o<65536?r[a++]=o:(o-=65536,r[a++]=55296|o>>10&1023,r[a++]=56320|o&1023)}return Al(r,a)},Tl=(e,n)=>{n=n||e.length,n>e.length&&(n=e.length);let t=n-1;for(;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?n:t+ft[e[t]]>n?t:n},ct={string2buf:El,buf2string:Sl,utf8border:Tl};function zl(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var da=zl;const ua=Object.prototype.toString,{Z_NO_FLUSH:Dl,Z_SYNC_FLUSH:Rl,Z_FULL_FLUSH:Zl,Z_FINISH:Il,Z_OK:Rt,Z_STREAM_END:Cl,Z_DEFAULT_COMPRESSION:Nl,Z_DEFAULT_STRATEGY:Ml,Z_DEFLATED:Ul}=De;function gt(e){this.options=Bt.assign({level:Nl,method:Ul,chunkSize:16384,windowBits:15,memLevel:8,strategy:Ml},e||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new da,this.strm.avail_out=0;let t=Je.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(t!==Rt)throw new Error(Se[t]);if(n.header&&Je.deflateSetHeader(this.strm,n.header),n.dictionary){let i;if(typeof n.dictionary=="string"?i=ct.string2buf(n.dictionary):ua.call(n.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(n.dictionary):i=n.dictionary,t=Je.deflateSetDictionary(this.strm,i),t!==Rt)throw new Error(Se[t]);this._dict_set=!0}}gt.prototype.push=function(e,n){const t=this.strm,i=this.options.chunkSize;let a,r;if(this.ended)return!1;for(n===~~n?r=n:r=n===!0?Il:Dl,typeof e=="string"?t.input=ct.string2buf(e):ua.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),(r===Rl||r===Zl)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(a=Je.deflate(t,r),a===Cl)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),a=Je.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===Rt;if(t.avail_out===0){this.onData(t.output);continue}if(r>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0};gt.prototype.onData=function(e){this.chunks.push(e)};gt.prototype.onEnd=function(e){e===Rt&&(this.result=Bt.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function kn(e,n){const t=new gt(n);if(t.push(e,!0),t.err)throw t.msg||Se[t.err];return t.result}function Ll(e,n){return n=n||{},n.raw=!0,kn(e,n)}function Ol(e,n){return n=n||{},n.gzip=!0,kn(e,n)}var Bl=gt,Fl=kn,Pl=Ll,Hl=Ol,Xl=De,Yl={Deflate:Bl,deflate:Fl,deflateRaw:Pl,gzip:Hl,constants:Xl};const kt=16209,Kl=16191;var Gl=function(n,t){let i,a,r,o,l,h,s,f,w,_,c,d,k,g,b,x,y,u,m,Z,v,R,T,p;const E=n.state;i=n.next_in,T=n.input,a=i+(n.avail_in-5),r=n.next_out,p=n.output,o=r-(t-n.avail_out),l=r+(n.avail_out-257),h=E.dmax,s=E.wsize,f=E.whave,w=E.wnext,_=E.window,c=E.hold,d=E.bits,k=E.lencode,g=E.distcode,b=(1<<E.lenbits)-1,x=(1<<E.distbits)-1;e:do{d<15&&(c+=T[i++]<<d,d+=8,c+=T[i++]<<d,d+=8),y=k[c&b];t:for(;;){if(u=y>>>24,c>>>=u,d-=u,u=y>>>16&255,u===0)p[r++]=y&65535;else if(u&16){m=y&65535,u&=15,u&&(d<u&&(c+=T[i++]<<d,d+=8),m+=c&(1<<u)-1,c>>>=u,d-=u),d<15&&(c+=T[i++]<<d,d+=8,c+=T[i++]<<d,d+=8),y=g[c&x];n:for(;;){if(u=y>>>24,c>>>=u,d-=u,u=y>>>16&255,u&16){if(Z=y&65535,u&=15,d<u&&(c+=T[i++]<<d,d+=8,d<u&&(c+=T[i++]<<d,d+=8)),Z+=c&(1<<u)-1,Z>h){n.msg="invalid distance too far back",E.mode=kt;break e}if(c>>>=u,d-=u,u=r-o,Z>u){if(u=Z-u,u>f&&E.sane){n.msg="invalid distance too far back",E.mode=kt;break e}if(v=0,R=_,w===0){if(v+=s-u,u<m){m-=u;do p[r++]=_[v++];while(--u);v=r-Z,R=p}}else if(w<u){if(v+=s+w-u,u-=w,u<m){m-=u;do p[r++]=_[v++];while(--u);if(v=0,w<m){u=w,m-=u;do p[r++]=_[v++];while(--u);v=r-Z,R=p}}}else if(v+=w-u,u<m){m-=u;do p[r++]=_[v++];while(--u);v=r-Z,R=p}for(;m>2;)p[r++]=R[v++],p[r++]=R[v++],p[r++]=R[v++],m-=3;m&&(p[r++]=R[v++],m>1&&(p[r++]=R[v++]))}else{v=r-Z;do p[r++]=p[v++],p[r++]=p[v++],p[r++]=p[v++],m-=3;while(m>2);m&&(p[r++]=p[v++],m>1&&(p[r++]=p[v++]))}}else if(u&64){n.msg="invalid distance code",E.mode=kt;break e}else{y=g[(y&65535)+(c&(1<<u)-1)];continue n}break}}else if(u&64)if(u&32){E.mode=Kl;break e}else{n.msg="invalid literal/length code",E.mode=kt;break e}else{y=k[(y&65535)+(c&(1<<u)-1)];continue t}break}}while(i<a&&r<l);m=d>>3,i-=m,d-=m<<3,c&=(1<<d)-1,n.next_in=i,n.next_out=r,n.avail_in=i<a?5+(a-i):5-(i-a),n.avail_out=r<l?257+(l-r):257-(r-l),E.hold=c,E.bits=d};const Ne=15,Gn=852,Wn=592,$n=0,jt=1,jn=2,Wl=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),$l=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),jl=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Vl=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ql=(e,n,t,i,a,r,o,l)=>{const h=l.bits;let s=0,f=0,w=0,_=0,c=0,d=0,k=0,g=0,b=0,x=0,y,u,m,Z,v,R=null,T;const p=new Uint16Array(Ne+1),E=new Uint16Array(Ne+1);let M=null,A,P,D;for(s=0;s<=Ne;s++)p[s]=0;for(f=0;f<i;f++)p[n[t+f]]++;for(c=h,_=Ne;_>=1&&p[_]===0;_--);if(c>_&&(c=_),_===0)return a[r++]=1<<24|64<<16|0,a[r++]=1<<24|64<<16|0,l.bits=1,0;for(w=1;w<_&&p[w]===0;w++);for(c<w&&(c=w),g=1,s=1;s<=Ne;s++)if(g<<=1,g-=p[s],g<0)return-1;if(g>0&&(e===$n||_!==1))return-1;for(E[1]=0,s=1;s<Ne;s++)E[s+1]=E[s]+p[s];for(f=0;f<i;f++)n[t+f]!==0&&(o[E[n[t+f]]++]=f);if(e===$n?(R=M=o,T=20):e===jt?(R=Wl,M=$l,T=257):(R=jl,M=Vl,T=0),x=0,f=0,s=w,v=r,d=c,k=0,m=-1,b=1<<c,Z=b-1,e===jt&&b>Gn||e===jn&&b>Wn)return 1;for(;;){A=s-k,o[f]+1<T?(P=0,D=o[f]):o[f]>=T?(P=M[o[f]-T],D=R[o[f]-T]):(P=96,D=0),y=1<<s-k,u=1<<d,w=u;do u-=y,a[v+(x>>k)+u]=A<<24|P<<16|D|0;while(u!==0);for(y=1<<s-1;x&y;)y>>=1;if(y!==0?(x&=y-1,x+=y):x=0,f++,--p[s]===0){if(s===_)break;s=n[t+o[f]]}if(s>c&&(x&Z)!==m){for(k===0&&(k=c),v+=w,d=s-k,g=1<<d;d+k<_&&(g-=p[d+k],!(g<=0));)d++,g<<=1;if(b+=1<<d,e===jt&&b>Gn||e===jn&&b>Wn)return 1;m=x&Z,a[m]=c<<24|d<<16|v-r|0}}return x!==0&&(a[v+x]=s-k<<24|64<<16|0),l.bits=c,0};var Qe=ql;const Jl=0,ba=1,wa=2,{Z_FINISH:Vn,Z_BLOCK:Ql,Z_TREES:xt,Z_OK:ze,Z_STREAM_END:eo,Z_NEED_DICT:to,Z_STREAM_ERROR:le,Z_DATA_ERROR:ga,Z_MEM_ERROR:ma,Z_BUF_ERROR:no,Z_DEFLATED:qn}=De,Ft=16180,Jn=16181,Qn=16182,ei=16183,ti=16184,ni=16185,ii=16186,ai=16187,ri=16188,li=16189,Zt=16190,de=16191,Vt=16192,oi=16193,qt=16194,si=16195,fi=16196,ci=16197,hi=16198,yt=16199,Et=16200,_i=16201,di=16202,ui=16203,bi=16204,wi=16205,Jt=16206,gi=16207,mi=16208,B=16209,pa=16210,va=16211,io=852,ao=592,ro=15,lo=ro,pi=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function oo(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Re=e=>{if(!e)return 1;const n=e.state;return!n||n.strm!==e||n.mode<Ft||n.mode>va?1:0},ka=e=>{if(Re(e))return le;const n=e.state;return e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=n.wrap&1),n.mode=Ft,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(io),n.distcode=n.distdyn=new Int32Array(ao),n.sane=1,n.back=-1,ze},xa=e=>{if(Re(e))return le;const n=e.state;return n.wsize=0,n.whave=0,n.wnext=0,ka(e)},ya=(e,n)=>{let t;if(Re(e))return le;const i=e.state;return n<0?(t=0,n=-n):(t=(n>>4)+5,n<48&&(n&=15)),n&&(n<8||n>15)?le:(i.window!==null&&i.wbits!==n&&(i.window=null),i.wrap=t,i.wbits=n,xa(e))},Ea=(e,n)=>{if(!e)return le;const t=new oo;e.state=t,t.strm=e,t.window=null,t.mode=Ft;const i=ya(e,n);return i!==ze&&(e.state=null),i},so=e=>Ea(e,lo);let vi=!0,Qt,en;const fo=e=>{if(vi){Qt=new Int32Array(512),en=new Int32Array(32);let n=0;for(;n<144;)e.lens[n++]=8;for(;n<256;)e.lens[n++]=9;for(;n<280;)e.lens[n++]=7;for(;n<288;)e.lens[n++]=8;for(Qe(ba,e.lens,0,288,Qt,0,e.work,{bits:9}),n=0;n<32;)e.lens[n++]=5;Qe(wa,e.lens,0,32,en,0,e.work,{bits:5}),vi=!1}e.lencode=Qt,e.lenbits=9,e.distcode=en,e.distbits=5},Aa=(e,n,t,i)=>{let a;const r=e.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),i>=r.wsize?(r.window.set(n.subarray(t-r.wsize,t),0),r.wnext=0,r.whave=r.wsize):(a=r.wsize-r.wnext,a>i&&(a=i),r.window.set(n.subarray(t-i,t-i+a),r.wnext),i-=a,i?(r.window.set(n.subarray(t-i,t),0),r.wnext=i,r.whave=r.wsize):(r.wnext+=a,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=a))),0},co=(e,n)=>{let t,i,a,r,o,l,h,s,f,w,_,c,d,k,g=0,b,x,y,u,m,Z,v,R;const T=new Uint8Array(4);let p,E;const M=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Re(e)||!e.output||!e.input&&e.avail_in!==0)return le;t=e.state,t.mode===de&&(t.mode=Vt),o=e.next_out,a=e.output,h=e.avail_out,r=e.next_in,i=e.input,l=e.avail_in,s=t.hold,f=t.bits,w=l,_=h,R=ze;e:for(;;)switch(t.mode){case Ft:if(t.wrap===0){t.mode=Vt;break}for(;f<16;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}if(t.wrap&2&&s===35615){t.wbits===0&&(t.wbits=15),t.check=0,T[0]=s&255,T[1]=s>>>8&255,t.check=K(t.check,T,2,0),s=0,f=0,t.mode=Jn;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((s&255)<<8)+(s>>8))%31){e.msg="incorrect header check",t.mode=B;break}if((s&15)!==qn){e.msg="unknown compression method",t.mode=B;break}if(s>>>=4,f-=4,v=(s&15)+8,t.wbits===0&&(t.wbits=v),v>15||v>t.wbits){e.msg="invalid window size",t.mode=B;break}t.dmax=1<<t.wbits,t.flags=0,e.adler=t.check=1,t.mode=s&512?li:de,s=0,f=0;break;case Jn:for(;f<16;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}if(t.flags=s,(t.flags&255)!==qn){e.msg="unknown compression method",t.mode=B;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=B;break}t.head&&(t.head.text=s>>8&1),t.flags&512&&t.wrap&4&&(T[0]=s&255,T[1]=s>>>8&255,t.check=K(t.check,T,2,0)),s=0,f=0,t.mode=Qn;case Qn:for(;f<32;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}t.head&&(t.head.time=s),t.flags&512&&t.wrap&4&&(T[0]=s&255,T[1]=s>>>8&255,T[2]=s>>>16&255,T[3]=s>>>24&255,t.check=K(t.check,T,4,0)),s=0,f=0,t.mode=ei;case ei:for(;f<16;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}t.head&&(t.head.xflags=s&255,t.head.os=s>>8),t.flags&512&&t.wrap&4&&(T[0]=s&255,T[1]=s>>>8&255,t.check=K(t.check,T,2,0)),s=0,f=0,t.mode=ti;case ti:if(t.flags&1024){for(;f<16;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}t.length=s,t.head&&(t.head.extra_len=s),t.flags&512&&t.wrap&4&&(T[0]=s&255,T[1]=s>>>8&255,t.check=K(t.check,T,2,0)),s=0,f=0}else t.head&&(t.head.extra=null);t.mode=ni;case ni:if(t.flags&1024&&(c=t.length,c>l&&(c=l),c&&(t.head&&(v=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(i.subarray(r,r+c),v)),t.flags&512&&t.wrap&4&&(t.check=K(t.check,i,c,r)),l-=c,r+=c,t.length-=c),t.length))break e;t.length=0,t.mode=ii;case ii:if(t.flags&2048){if(l===0)break e;c=0;do v=i[r+c++],t.head&&v&&t.length<65536&&(t.head.name+=String.fromCharCode(v));while(v&&c<l);if(t.flags&512&&t.wrap&4&&(t.check=K(t.check,i,c,r)),l-=c,r+=c,v)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=ai;case ai:if(t.flags&4096){if(l===0)break e;c=0;do v=i[r+c++],t.head&&v&&t.length<65536&&(t.head.comment+=String.fromCharCode(v));while(v&&c<l);if(t.flags&512&&t.wrap&4&&(t.check=K(t.check,i,c,r)),l-=c,r+=c,v)break e}else t.head&&(t.head.comment=null);t.mode=ri;case ri:if(t.flags&512){for(;f<16;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}if(t.wrap&4&&s!==(t.check&65535)){e.msg="header crc mismatch",t.mode=B;break}s=0,f=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=de;break;case li:for(;f<32;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}e.adler=t.check=pi(s),s=0,f=0,t.mode=Zt;case Zt:if(t.havedict===0)return e.next_out=o,e.avail_out=h,e.next_in=r,e.avail_in=l,t.hold=s,t.bits=f,to;e.adler=t.check=1,t.mode=de;case de:if(n===Ql||n===xt)break e;case Vt:if(t.last){s>>>=f&7,f-=f&7,t.mode=Jt;break}for(;f<3;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}switch(t.last=s&1,s>>>=1,f-=1,s&3){case 0:t.mode=oi;break;case 1:if(fo(t),t.mode=yt,n===xt){s>>>=2,f-=2;break e}break;case 2:t.mode=fi;break;case 3:e.msg="invalid block type",t.mode=B}s>>>=2,f-=2;break;case oi:for(s>>>=f&7,f-=f&7;f<32;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}if((s&65535)!==(s>>>16^65535)){e.msg="invalid stored block lengths",t.mode=B;break}if(t.length=s&65535,s=0,f=0,t.mode=qt,n===xt)break e;case qt:t.mode=si;case si:if(c=t.length,c){if(c>l&&(c=l),c>h&&(c=h),c===0)break e;a.set(i.subarray(r,r+c),o),l-=c,r+=c,h-=c,o+=c,t.length-=c;break}t.mode=de;break;case fi:for(;f<14;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}if(t.nlen=(s&31)+257,s>>>=5,f-=5,t.ndist=(s&31)+1,s>>>=5,f-=5,t.ncode=(s&15)+4,s>>>=4,f-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=B;break}t.have=0,t.mode=ci;case ci:for(;t.have<t.ncode;){for(;f<3;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}t.lens[M[t.have++]]=s&7,s>>>=3,f-=3}for(;t.have<19;)t.lens[M[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,p={bits:t.lenbits},R=Qe(Jl,t.lens,0,19,t.lencode,0,t.work,p),t.lenbits=p.bits,R){e.msg="invalid code lengths set",t.mode=B;break}t.have=0,t.mode=hi;case hi:for(;t.have<t.nlen+t.ndist;){for(;g=t.lencode[s&(1<<t.lenbits)-1],b=g>>>24,x=g>>>16&255,y=g&65535,!(b<=f);){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}if(y<16)s>>>=b,f-=b,t.lens[t.have++]=y;else{if(y===16){for(E=b+2;f<E;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}if(s>>>=b,f-=b,t.have===0){e.msg="invalid bit length repeat",t.mode=B;break}v=t.lens[t.have-1],c=3+(s&3),s>>>=2,f-=2}else if(y===17){for(E=b+3;f<E;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}s>>>=b,f-=b,v=0,c=3+(s&7),s>>>=3,f-=3}else{for(E=b+7;f<E;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}s>>>=b,f-=b,v=0,c=11+(s&127),s>>>=7,f-=7}if(t.have+c>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=B;break}for(;c--;)t.lens[t.have++]=v}}if(t.mode===B)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=B;break}if(t.lenbits=9,p={bits:t.lenbits},R=Qe(ba,t.lens,0,t.nlen,t.lencode,0,t.work,p),t.lenbits=p.bits,R){e.msg="invalid literal/lengths set",t.mode=B;break}if(t.distbits=6,t.distcode=t.distdyn,p={bits:t.distbits},R=Qe(wa,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,p),t.distbits=p.bits,R){e.msg="invalid distances set",t.mode=B;break}if(t.mode=yt,n===xt)break e;case yt:t.mode=Et;case Et:if(l>=6&&h>=258){e.next_out=o,e.avail_out=h,e.next_in=r,e.avail_in=l,t.hold=s,t.bits=f,Gl(e,_),o=e.next_out,a=e.output,h=e.avail_out,r=e.next_in,i=e.input,l=e.avail_in,s=t.hold,f=t.bits,t.mode===de&&(t.back=-1);break}for(t.back=0;g=t.lencode[s&(1<<t.lenbits)-1],b=g>>>24,x=g>>>16&255,y=g&65535,!(b<=f);){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}if(x&&!(x&240)){for(u=b,m=x,Z=y;g=t.lencode[Z+((s&(1<<u+m)-1)>>u)],b=g>>>24,x=g>>>16&255,y=g&65535,!(u+b<=f);){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}s>>>=u,f-=u,t.back+=u}if(s>>>=b,f-=b,t.back+=b,t.length=y,x===0){t.mode=wi;break}if(x&32){t.back=-1,t.mode=de;break}if(x&64){e.msg="invalid literal/length code",t.mode=B;break}t.extra=x&15,t.mode=_i;case _i:if(t.extra){for(E=t.extra;f<E;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}t.length+=s&(1<<t.extra)-1,s>>>=t.extra,f-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=di;case di:for(;g=t.distcode[s&(1<<t.distbits)-1],b=g>>>24,x=g>>>16&255,y=g&65535,!(b<=f);){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}if(!(x&240)){for(u=b,m=x,Z=y;g=t.distcode[Z+((s&(1<<u+m)-1)>>u)],b=g>>>24,x=g>>>16&255,y=g&65535,!(u+b<=f);){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}s>>>=u,f-=u,t.back+=u}if(s>>>=b,f-=b,t.back+=b,x&64){e.msg="invalid distance code",t.mode=B;break}t.offset=y,t.extra=x&15,t.mode=ui;case ui:if(t.extra){for(E=t.extra;f<E;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}t.offset+=s&(1<<t.extra)-1,s>>>=t.extra,f-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=B;break}t.mode=bi;case bi:if(h===0)break e;if(c=_-h,t.offset>c){if(c=t.offset-c,c>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=B;break}c>t.wnext?(c-=t.wnext,d=t.wsize-c):d=t.wnext-c,c>t.length&&(c=t.length),k=t.window}else k=a,d=o-t.offset,c=t.length;c>h&&(c=h),h-=c,t.length-=c;do a[o++]=k[d++];while(--c);t.length===0&&(t.mode=Et);break;case wi:if(h===0)break e;a[o++]=t.length,h--,t.mode=Et;break;case Jt:if(t.wrap){for(;f<32;){if(l===0)break e;l--,s|=i[r++]<<f,f+=8}if(_-=h,e.total_out+=_,t.total+=_,t.wrap&4&&_&&(e.adler=t.check=t.flags?K(t.check,a,_,o-_):st(t.check,a,_,o-_)),_=h,t.wrap&4&&(t.flags?s:pi(s))!==t.check){e.msg="incorrect data check",t.mode=B;break}s=0,f=0}t.mode=gi;case gi:if(t.wrap&&t.flags){for(;f<32;){if(l===0)break e;l--,s+=i[r++]<<f,f+=8}if(t.wrap&4&&s!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=B;break}s=0,f=0}t.mode=mi;case mi:R=eo;break e;case B:R=ga;break e;case pa:return ma;case va:default:return le}return e.next_out=o,e.avail_out=h,e.next_in=r,e.avail_in=l,t.hold=s,t.bits=f,(t.wsize||_!==e.avail_out&&t.mode<B&&(t.mode<Jt||n!==Vn))&&Aa(e,e.output,e.next_out,_-e.avail_out),w-=e.avail_in,_-=e.avail_out,e.total_in+=w,e.total_out+=_,t.total+=_,t.wrap&4&&_&&(e.adler=t.check=t.flags?K(t.check,a,_,e.next_out-_):st(t.check,a,_,e.next_out-_)),e.data_type=t.bits+(t.last?64:0)+(t.mode===de?128:0)+(t.mode===yt||t.mode===qt?256:0),(w===0&&_===0||n===Vn)&&R===ze&&(R=no),R},ho=e=>{if(Re(e))return le;let n=e.state;return n.window&&(n.window=null),e.state=null,ze},_o=(e,n)=>{if(Re(e))return le;const t=e.state;return t.wrap&2?(t.head=n,n.done=!1,ze):le},uo=(e,n)=>{const t=n.length;let i,a,r;return Re(e)||(i=e.state,i.wrap!==0&&i.mode!==Zt)?le:i.mode===Zt&&(a=1,a=st(a,n,t,0),a!==i.check)?ga:(r=Aa(e,n,t,t),r?(i.mode=pa,ma):(i.havedict=1,ze))};var bo=xa,wo=ya,go=ka,mo=so,po=Ea,vo=co,ko=ho,xo=_o,yo=uo,Eo="pako inflate (from Nodeca project)",be={inflateReset:bo,inflateReset2:wo,inflateResetKeep:go,inflateInit:mo,inflateInit2:po,inflate:vo,inflateEnd:ko,inflateGetHeader:xo,inflateSetDictionary:yo,inflateInfo:Eo};function Ao(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var So=Ao;const Sa=Object.prototype.toString,{Z_NO_FLUSH:To,Z_FINISH:zo,Z_OK:ht,Z_STREAM_END:tn,Z_NEED_DICT:nn,Z_STREAM_ERROR:Do,Z_DATA_ERROR:ki,Z_MEM_ERROR:Ro}=De;function mt(e){this.options=Bt.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(e&&e.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(n.windowBits&15||(n.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new da,this.strm.avail_out=0;let t=be.inflateInit2(this.strm,n.windowBits);if(t!==ht)throw new Error(Se[t]);if(this.header=new So,be.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=ct.string2buf(n.dictionary):Sa.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(t=be.inflateSetDictionary(this.strm,n.dictionary),t!==ht)))throw new Error(Se[t])}mt.prototype.push=function(e,n){const t=this.strm,i=this.options.chunkSize,a=this.options.dictionary;let r,o,l;if(this.ended)return!1;for(n===~~n?o=n:o=n===!0?zo:To,Sa.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(i),t.next_out=0,t.avail_out=i),r=be.inflate(t,o),r===nn&&a&&(r=be.inflateSetDictionary(t,a),r===ht?r=be.inflate(t,o):r===ki&&(r=nn));t.avail_in>0&&r===tn&&t.state.wrap>0&&e[t.next_in]!==0;)be.inflateReset(t),r=be.inflate(t,o);switch(r){case Do:case ki:case nn:case Ro:return this.onEnd(r),this.ended=!0,!1}if(l=t.avail_out,t.next_out&&(t.avail_out===0||r===tn))if(this.options.to==="string"){let h=ct.utf8border(t.output,t.next_out),s=t.next_out-h,f=ct.buf2string(t.output,h);t.next_out=s,t.avail_out=i-s,s&&t.output.set(t.output.subarray(h,h+s),0),this.onData(f)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(r===ht&&l===0)){if(r===tn)return r=be.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};mt.prototype.onData=function(e){this.chunks.push(e)};mt.prototype.onEnd=function(e){e===ht&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Bt.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function xn(e,n){const t=new mt(n);if(t.push(e),t.err)throw t.msg||Se[t.err];return t.result}function Zo(e,n){return n=n||{},n.raw=!0,xn(e,n)}var Io=mt,Co=xn,No=Zo,Mo=xn,Uo=De,Lo={Inflate:Io,inflate:Co,inflateRaw:No,ungzip:Mo,constants:Uo};const{Deflate:Oo,deflate:Bo,deflateRaw:Fo,gzip:Po}=Yl,{Inflate:Ho,inflate:Xo,inflateRaw:Yo,ungzip:Ko}=Lo;var Go=Oo,Wo=Bo,$o=Fo,jo=Po,Vo=Ho,qo=Xo,Jo=Yo,Qo=Ko,es=De,xi={Deflate:Go,deflate:Wo,deflateRaw:$o,gzip:jo,Inflate:Vo,inflate:qo,inflateRaw:Jo,ungzip:Qo,constants:es};class yi{constructor(n){C(this,"buffer");C(this,"bytePointer",0);C(this,"bitPointer",0);this.buffer=typeof n=="number"?new ArrayBuffer(n):"buffer"in n?n.buffer:n}get view(){return new DataView(this.buffer)}skipBits(n){this.bitPointer+=n,this.bytePointer+=Math.floor(this.bitPointer/8),this.bitPointer%=8}final(){return this.buffer.slice(0,this.bitPointer==0?this.bytePointer:this.bytePointer+1)}readBit(){const t=(this.view.getUint8(this.bytePointer)>>this.bitPointer&1)!=0;return this.skipBits(1),t}readBits(n){let t=0;for(let i=0;i<n;i++)t|=(this.readBit()?1:0)<<i;return t}writeBit(n){let t=this.view.getUint8(this.bytePointer);n?t|=1<<this.bitPointer:t&=1<<this.bitPointer^255,this.view.setUint8(this.bytePointer,t),this.skipBits(1)}writeBits(n,t){for(let i=0;i<n;i++)this.writeBit((t&1)!=0),t>>=1}}const Y=64;function yn(e,n){return()=>{e|=0,e=e+2654435769|0;let t=e^e>>>16;t=Math.imul(t,569420461),t=t^t>>>15,t=Math.imul(t,1935289751);const i=(t=t^t>>>15)>>>0;return n?i/4294967296:i}}function Ae(e,n,t,i){return e^=e<<13|e>>>17,e=e*2158630691+3333583613&4294967295,e^=n,e^=e<<13|e>>>17,e=e*2158630691+3333583613&4294967295,e^=t,e^=e<<13|e>>>17,e=e*2158630691+3333583613&4294967295,e^=i,e^=e<<16|e>>>15,e=e*2158630691+3333583613&4294967295,(e>>>0)/4294967295}function ts(e,n){n*=e.reduce((t,i)=>t+i,0);for(let t=0;t<e.length;t++)if(n-=e[t],n<=0)return t;throw new Error("Invalid weights")}function ns(e,n,t,i){let a=[];for(let l=Math.floor(n)-1;l<Math.ceil(n)+1;l++)for(let h=Math.floor(t)-1;h<Math.ceil(t)+1;h++)a.push({x:l+Ae(e,l,h,0)-.5,y:h+Ae(e,l,h,1)-.5,type:ts(i,Ae(e,l,h,2))});let r=1/0,o=-1;for(const l of a){const h=Math.sqrt((l.x-n)**2+(l.y-t)**2);h<r&&(r=h,o=l.type)}if(o==-1)throw new Error("Voronoi noise error.");return o}function Ei(e,n,t){function i(c,d,k){return(d-c)*((k*(k*6-15)+10)*k*k*k)+c}const a=(c,d)=>{const k=Ae(e,c,d,0);return{x:Math.cos(k),y:Math.sin(k)}},r=(c,d,k,g)=>{const b=a(c,d),x=k-c,y=g-d;return x*b.x+y*b.y},o=Math.floor(n),l=o+1,h=Math.floor(t),s=h+1,f=n-o,w=t-h;return i(i(r(o,h,n,t),r(l,h,n,t),f),i(r(o,s,n,t),r(l,s,n,t),f),w)}class is{constructor(n,t){C(this,"textures");C(this,"src");C(this,"img");this.src=n,this.img=document.createElement("img"),this.img.src=this.src,this.textures=t}awaitLoad(){return new Promise((n,t)=>{if(this.img.naturalWidth!==0)return n();const i=()=>{this.img.removeEventListener("load",i),this.img.removeEventListener("error",a),n()},a=()=>{this.img.removeEventListener("load",i),this.img.removeEventListener("error",a),t()};this.img.addEventListener("load",i),this.img.addEventListener("error",a)})}onLoad(n){this.awaitLoad().then(()=>n(this))}draw(n,t,i,a,r,o){const[l,h,s,f]=this.textures[t];n.drawImage(this.img,l,h,s,f,i,a,r,o)}}const O=new is("/infinite-minesweeper/tileset.png",{null:[0,0,16,16],bomb:[16,0,16,16],explosion:[16,16,16,16],flag:[32,16,16,16],number_0:[48,0,16,16],number_1:[48,16,16,16],number_2:[48,32,16,16],number_3:[48,48,16,16],number_4:[48,64,16,16],number_5:[48,80,16,16],number_6:[48,96,16,16],number_7:[48,112,16,16],number_8:[48,128,16,16],vanilla_tile_covered:[64,0,16,16],vanilla_tile_revealed:[80,0,16,16],chocolate_tile_covered:[64,16,16,16],chocolate_tile_revealed:[80,16,16,16],waffle_tile_covered_light:[64,32,16,16],waffle_tile_revealed_light:[80,32,16,16],waffle_tile_covered_dark:[96,32,16,16],waffle_tile_revealed_dark:[112,32,16,16],stroopwafel_tile_covered_light:[64,48,16,16],stroopwafel_tile_revealed_light:[80,48,16,16],stroopwafel_tile_covered_dark:[96,48,16,16],stroopwafel_tile_revealed_dark:[112,48,16,16]});function Pt(e){switch(e){case 0:return"number_0";case 1:return"number_1";case 2:return"number_2";case 3:return"number_3";case 4:return"number_4";case 5:return"number_5";case 6:return"number_6";case 7:return"number_7";case 8:return"number_8";default:return"null"}}class as{constructor(n,t,i){C(this,"world");C(this,"x");C(this,"y");this.world=n,this.x=t,this.y=i}minesNearby(){let n=0;for(const t of this.searchPattern)n+=this.world.getTile(this.x+t.x,this.y+t.y).numMines();return n}flagsNearby(){let n=0;for(const t of this.searchPattern)n+=this.world.getTile(this.x+t.x,this.y+t.y).numFlags();return n}static load(n,t,i,a){throw new Error("Tile.load needs to be implemented on derived class.")}}class Ht extends as{constructor(t,i,a,r){super(t,i,a);C(this,"isMine");C(this,"state",0);C(this,"searchPattern",[{x:-1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1},{x:1,y:0},{x:1,y:-1},{x:0,y:-1},{x:-1,y:-1}]);this.isMine=r}numMines(){return this.isMine?1:0}numFlags(){return this.state==1?1:0}flag(){this.state!=2&&(this.state==0?this.state=1:this.state=0)}reveal(){this.state!=1&&(this.state=2)}}class En extends Ht{constructor(n,t,i){const a=Ae(n.tileSeed,t,i,0)>.875;super(n,t,i,a)}render(n){switch(this.state){case 0:{O.draw(n,"vanilla_tile_covered",0,0,1,1);break}case 1:{O.draw(n,"vanilla_tile_covered",0,0,1,1),O.draw(n,"flag",0,0,1,1);break}case 2:{O.draw(n,"vanilla_tile_revealed",0,0,1,1),this.isMine?O.draw(n,"bomb",0,0,1,1):O.draw(n,Pt(this.minesNearby()),0,0,1,1);break}}}save(n){n.writeBits(2,this.state)}static load(n,t,i,a){const r=new En(n,t,i);switch(a.readBits(2)){case 0:break;case 1:r.flag();break;case 2:r.reveal();break}return r}}class An extends Ht{constructor(n,t,i){const a=Ae(n.tileSeed,t,i,0)>.625;super(n,t,i,a)}render(n){switch(this.state){case 0:{O.draw(n,"chocolate_tile_covered",0,0,1,1);break}case 1:{O.draw(n,"chocolate_tile_covered",0,0,1,1),O.draw(n,"flag",0,0,1,1);break}case 2:{O.draw(n,"chocolate_tile_revealed",0,0,1,1),this.isMine?O.draw(n,"bomb",0,0,1,1):O.draw(n,Pt(this.minesNearby()),0,0,1,1);break}}}save(n){n.writeBits(2,this.state)}static load(n,t,i,a){const r=new An(n,t,i);switch(a.readBits(2)){case 0:break;case 1:r.flag();break;case 2:r.reveal();break}return r}}function Ta(e,n,t,i){const a=Math.floor(t/n),r=Math.floor(i/n),o=(a+r%2)%2==0,l=Math.abs(t%n)+Math.abs(i%n)*n,h=Math.floor(Ae(e.tileSeed,a,r,0)*n**2),s=o?l!=h:l==h;return{isDark:o,isMine:s}}class Sn extends Ht{constructor(t,i,a){const{isDark:r,isMine:o}=Ta(t,2,i,a);super(t,i,a,o);C(this,"isDark");this.isDark=r}render(t){switch(this.state){case 0:{O.draw(t,this.isDark?"waffle_tile_covered_dark":"waffle_tile_covered_light",0,0,1,1);break}case 1:{O.draw(t,this.isDark?"waffle_tile_covered_dark":"waffle_tile_covered_light",0,0,1,1),O.draw(t,"flag",0,0,1,1);break}case 2:{O.draw(t,this.isDark?"waffle_tile_revealed_dark":"waffle_tile_revealed_light",0,0,1,1),this.isMine?O.draw(t,"bomb",0,0,1,1):O.draw(t,Pt(this.minesNearby()),0,0,1,1);break}}}save(t){t.writeBits(2,this.state)}static load(t,i,a,r){const o=new Sn(t,i,a);switch(r.readBits(2)){case 0:break;case 1:o.flag();break;case 2:o.reveal();break}return o}}class Tn extends Ht{constructor(t,i,a){const{isDark:r,isMine:o}=Ta(t,3,i,a);super(t,i,a,o);C(this,"isDark");this.isDark=r}render(t){switch(this.state){case 0:{O.draw(t,this.isDark?"stroopwafel_tile_covered_dark":"stroopwafel_tile_covered_light",0,0,1,1);break}case 1:{O.draw(t,this.isDark?"stroopwafel_tile_covered_dark":"stroopwafel_tile_covered_light",0,0,1,1),O.draw(t,"flag",0,0,1,1);break}case 2:{O.draw(t,this.isDark?"stroopwafel_tile_revealed_dark":"stroopwafel_tile_revealed_light",0,0,1,1),this.isMine?O.draw(t,"bomb",0,0,1,1):O.draw(t,Pt(this.minesNearby()),0,0,1,1);break}}}save(t){t.writeBits(2,this.state)}static load(t,i,a,r){const o=new Tn(t,i,a);switch(r.readBits(2)){case 0:break;case 1:o.flag();break;case 2:o.reveal();break}return o}}const rs={type:"collection",weight:1,scale:24,smoothness:.8,biomes:[{type:"collection",weight:5,scale:24,smoothness:.8,biomes:[{type:"biome",weight:3,tile:En},{type:"biome",weight:1,tile:An}]},{type:"collection",weight:2,scale:64,smoothness:0,biomes:[{type:"biome",weight:1,tile:Sn},{type:"biome",weight:2,tile:Tn}]}]};function ls(e,n,t,i,a){const r=yn(e,!1),o=Ei(r(),n,t)*i,l=Ei(r(),n,t)*i;return ns(r(),n+o,t+l,a)}function za(e,n,t){const i=yn(e.biomeSeed,!1);let a=rs;for(;a.type=="collection";){const r=ls(i(),n/a.scale,t/a.scale,a.smoothness,a.biomes.map(o=>o.weight));a=a.biomes[r]}return a.tile}function os(e,n,t){const i=za(e,n,t);return new i(e,n,t)}class Da{constructor(n,t,i){C(this,"world");C(this,"chunkX");C(this,"chunkY");this.world=n,this.chunkX=t,this.chunkY=i}isGenerated(){return this instanceof _t}generate(){if(this.isGenerated())throw new Error("Cannot generate an already generated chunk.");console.log(`Generating new chunk: ${this.chunkX}, ${this.chunkY}`);const n=[];for(let t=0;t<Y;t++)for(let i=0;i<Y;i++){const a=this.world.generateTile(this.chunkX*Y+i,this.chunkY*Y+t);n.push(a)}return new _t(this.world,this.chunkX,this.chunkY,n)}}class _t extends Da{constructor(t,i,a,r){super(t,i,a);C(this,"tiles");if(this.tiles=r,this.tiles.length!=Y*Y)throw new Error("GeneratedChunk incorrect tiles length.")}getTileAbsolute(t,i){return this.getTile(t-this.chunkX*Y,i-this.chunkY*Y)}getTile(t,i){return this.tiles[t+i*Y]}save(){const t=new yi(2048);for(const i of this.tiles)i.save(t);return xi.deflate(t.final()).buffer}static load(t,i,a,r){const o=new yi(xi.inflate(r));let l=[];for(let h=0;h<Y;h++)for(let s=0;s<Y;s++){const f=i*Y+s,w=a*Y+h,c=za(t,f,w).load(t,f,w,o);l.push(c)}return new _t(t,i,a,l)}}const Ra="3.7.7",ss=Ra,Ke=typeof Buffer=="function",Ai=typeof TextDecoder=="function"?new TextDecoder:void 0,Si=typeof TextEncoder=="function"?new TextEncoder:void 0,fs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ve=Array.prototype.slice.call(fs),At=(e=>{let n={};return e.forEach((t,i)=>n[t]=i),n})(Ve),cs=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,$=String.fromCharCode.bind(String),Ti=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),Za=e=>e.replace(/=/g,"").replace(/[+\/]/g,n=>n=="+"?"-":"_"),Ia=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),Ca=e=>{let n,t,i,a,r="";const o=e.length%3;for(let l=0;l<e.length;){if((t=e.charCodeAt(l++))>255||(i=e.charCodeAt(l++))>255||(a=e.charCodeAt(l++))>255)throw new TypeError("invalid character found");n=t<<16|i<<8|a,r+=Ve[n>>18&63]+Ve[n>>12&63]+Ve[n>>6&63]+Ve[n&63]}return o?r.slice(0,o-3)+"===".substring(o):r},zn=typeof btoa=="function"?e=>btoa(e):Ke?e=>Buffer.from(e,"binary").toString("base64"):Ca,un=Ke?e=>Buffer.from(e).toString("base64"):e=>{let t=[];for(let i=0,a=e.length;i<a;i+=4096)t.push($.apply(null,e.subarray(i,i+4096)));return zn(t.join(""))},Tt=(e,n=!1)=>n?Za(un(e)):un(e),hs=e=>{if(e.length<2){var n=e.charCodeAt(0);return n<128?e:n<2048?$(192|n>>>6)+$(128|n&63):$(224|n>>>12&15)+$(128|n>>>6&63)+$(128|n&63)}else{var n=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return $(240|n>>>18&7)+$(128|n>>>12&63)+$(128|n>>>6&63)+$(128|n&63)}},_s=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Na=e=>e.replace(_s,hs),zi=Ke?e=>Buffer.from(e,"utf8").toString("base64"):Si?e=>un(Si.encode(e)):e=>zn(Na(e)),Ue=(e,n=!1)=>n?Za(zi(e)):zi(e),Di=e=>Ue(e,!0),ds=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,us=e=>{switch(e.length){case 4:var n=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),t=n-65536;return $((t>>>10)+55296)+$((t&1023)+56320);case 3:return $((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return $((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},Ma=e=>e.replace(ds,us),Ua=e=>{if(e=e.replace(/\s+/g,""),!cs.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let n,t="",i,a;for(let r=0;r<e.length;)n=At[e.charAt(r++)]<<18|At[e.charAt(r++)]<<12|(i=At[e.charAt(r++)])<<6|(a=At[e.charAt(r++)]),t+=i===64?$(n>>16&255):a===64?$(n>>16&255,n>>8&255):$(n>>16&255,n>>8&255,n&255);return t},Dn=typeof atob=="function"?e=>atob(Ia(e)):Ke?e=>Buffer.from(e,"base64").toString("binary"):Ua,La=Ke?e=>Ti(Buffer.from(e,"base64")):e=>Ti(Dn(e).split("").map(n=>n.charCodeAt(0))),Oa=e=>La(Ba(e)),bs=Ke?e=>Buffer.from(e,"base64").toString("utf8"):Ai?e=>Ai.decode(La(e)):e=>Ma(Dn(e)),Ba=e=>Ia(e.replace(/[-_]/g,n=>n=="-"?"+":"/")),bn=e=>bs(Ba(e)),ws=e=>{if(typeof e!="string")return!1;const n=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(n)||!/[^\s0-9a-zA-Z\-_]/.test(n)},Fa=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),Pa=function(){const e=(n,t)=>Object.defineProperty(String.prototype,n,Fa(t));e("fromBase64",function(){return bn(this)}),e("toBase64",function(n){return Ue(this,n)}),e("toBase64URI",function(){return Ue(this,!0)}),e("toBase64URL",function(){return Ue(this,!0)}),e("toUint8Array",function(){return Oa(this)})},Ha=function(){const e=(n,t)=>Object.defineProperty(Uint8Array.prototype,n,Fa(t));e("toBase64",function(n){return Tt(this,n)}),e("toBase64URI",function(){return Tt(this,!0)}),e("toBase64URL",function(){return Tt(this,!0)})},gs=()=>{Pa(),Ha()},Ri={version:Ra,VERSION:ss,atob:Dn,atobPolyfill:Ua,btoa:zn,btoaPolyfill:Ca,fromBase64:bn,toBase64:Ue,encode:Ue,encodeURI:Di,encodeURL:Di,utob:Na,btou:Ma,decode:bn,isValid:ws,fromUint8Array:Tt,toUint8Array:Oa,extendString:Pa,extendUint8Array:Ha,extendBuiltins:gs};function*ms(e,n){let t=e,i=n,a=1,r=1;for(;;){for(;2*t*a<r;)yield{x:t,y:i},t+=a;for(;2*i*a<r;)yield{x:t,y:i},i+=a;a=-1*a,r+=1}}class It{constructor(n){C(this,"seed");C(this,"tileSeed");C(this,"biomeSeed");C(this,"chunks",{});this.seed=n;const t=yn(this.seed,!1);this.tileSeed=t(),this.biomeSeed=t()}generateTile(n,t){return os(this,n,t)}getChunk(n,t){const i=this.chunks[`${n},${t}`];return i||new Da(this,n,t)}getGeneratedChunk(n,t){const i=this.getChunk(n,t);if(i.isGenerated())return i;const a=i.generate();return this.chunks[`${n},${t}`]=a,a}getTile(n,t){const i=Math.floor(n/Y),a=Math.floor(t/Y);return this.getGeneratedChunk(i,a).getTileAbsolute(n,t)}flag(n,t){return this.getTile(n,t).flag()}reveal(n,t,i=!0){const a=this.getTile(n,t);if(a.reveal(),a.numMines()>0)return!0;if(a.minesNearby()>0)if(i){let l=!1;if(a.flagsNearby()==a.minesNearby())for(const h of a.searchPattern)this.reveal(a.x+h.x,a.y+h.y,!1)&&(l=!0);return l}else return!1;let r=[],o=[a];for(;o.length>0;){const l=o.pop();r.push(l);for(const h of l.searchPattern){const s=this.getTile(l.x+h.x,l.y+h.y);o.some(f=>f.x==s.x&&f.y==s.y)||r.some(f=>f.x==s.x&&f.y==s.y)||(s.minesNearby()==0?o.push(s):r.push(s))}}return r.forEach(l=>l.reveal()),!1}closest0(n,t){for(const{x:i,y:a}of ms(n,t)){const r=this.getTile(i,a);if(r.numMines()==0&&r.minesNearby()==0)return{x:i,y:a}}throw new Error("This error should never happen, it's just here to make TypeScript happy.")}save(){const n={seed:this.seed,chunks:{}};for(const t in this.chunks){const i=t,r=this.chunks[i].save();n.chunks[i]=Ri.fromUint8Array(new Uint8Array(r))}return n}static load(n){const t=new It(n.seed);for(const i in n.chunks){const a=i,r=n.chunks[a],o=Ri.toUint8Array(r).buffer,[l,h,s]=a.match(/^(-?\d+),(-?\d+)$/),[f,w]=[parseInt(h),parseInt(s)];t.chunks[a]=_t.load(t,f,w,o)}return t}}const ps=(e,n)=>{const t=new ResizeObserver(()=>{n(e.clientWidth,e.clientHeight)});return t.observe(e),{destroy(){t.unobserve(e),t.disconnect()}}};/**
 * @license lucide-svelte v0.372.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"},Zi=vs;function Ii(e,n,t){const i=e.slice();return i[10]=n[t][0],i[11]=n[t][1],i}function an(e){let n,t=[e[11]],i={};for(let a=0;a<t.length;a+=1)i=_e(i,t[a]);return{c(){n=Pi(e[10]),this.h()},l(a){n=Hi(a,e[10],{}),F(n).forEach(S),this.h()},h(){zt(n,i)},m(a,r){X(a,n,r)},p(a,r){zt(n,i=Lt(t,[r&32&&a[11]]))},d(a){a&&S(n)}}}function Ci(e){let n=e[10],t,i=e[10]&&an(e);return{c(){i&&i.c(),t=Oe()},l(a){i&&i.l(a),t=Oe()},m(a,r){i&&i.m(a,r),X(a,t,r)},p(a,r){a[10]?n?Pe(n,a[10])?(i.d(1),i=an(a),n=a[10],i.c(),i.m(t.parentNode,t)):i.p(a,r):(i=an(a),n=a[10],i.c(),i.m(t.parentNode,t)):n&&(i.d(1),i=null,n=a[10])},d(a){a&&S(t),i&&i.d(a)}}}function ks(e){let n,t,i,a,r,o=Mn(e[5]),l=[];for(let _=0;_<o.length;_+=1)l[_]=Ci(Ii(e,o,_));const h=e[9].default,s=Ct(h,e,e[8],null);let f=[Zi,e[6],{width:e[2]},{height:e[2]},{stroke:e[1]},{"stroke-width":i=e[4]?Number(e[3])*24/Number(e[2]):e[3]},{class:a=`lucide-icon lucide lucide-${e[0]} ${e[7].class??""}`}],w={};for(let _=0;_<f.length;_+=1)w=_e(w,f[_]);return{c(){n=Pi("svg");for(let _=0;_<l.length;_+=1)l[_].c();t=Oe(),s&&s.c(),this.h()},l(_){n=Hi(_,"svg",{width:!0,height:!0,stroke:!0,"stroke-width":!0,class:!0});var c=F(n);for(let d=0;d<l.length;d+=1)l[d].l(c);t=Oe(),s&&s.l(c),c.forEach(S),this.h()},h(){zt(n,w)},m(_,c){X(_,n,c);for(let d=0;d<l.length;d+=1)l[d]&&l[d].m(n,null);z(n,t),s&&s.m(n,null),r=!0},p(_,[c]){if(c&32){o=Mn(_[5]);let d;for(d=0;d<o.length;d+=1){const k=Ii(_,o,d);l[d]?l[d].p(k,c):(l[d]=Ci(k),l[d].c(),l[d].m(n,t))}for(;d<l.length;d+=1)l[d].d(1);l.length=o.length}s&&s.p&&(!r||c&256)&&Nt(s,h,_,_[8],r?Ut(h,_[8],c,null):Mt(_[8]),null),zt(n,w=Lt(f,[Zi,c&64&&_[6],(!r||c&4)&&{width:_[2]},(!r||c&4)&&{height:_[2]},(!r||c&2)&&{stroke:_[1]},(!r||c&28&&i!==(i=_[4]?Number(_[3])*24/Number(_[2]):_[3]))&&{"stroke-width":i},(!r||c&129&&a!==(a=`lucide-icon lucide lucide-${_[0]} ${_[7].class??""}`))&&{class:a}]))},i(_){r||(q(s,_),r=!0)},o(_){ae(s,_),r=!1},d(_){_&&S(n),Qa(l,_),s&&s.d(_)}}}function xs(e,n,t){const i=["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"];let a=Nn(n,i),{$$slots:r={},$$scope:o}=n,{name:l}=n,{color:h="currentColor"}=n,{size:s=24}=n,{strokeWidth:f=2}=n,{absoluteStrokeWidth:w=!1}=n,{iconNode:_}=n;return e.$$set=c=>{t(7,n=_e(_e({},n),Le(c))),t(6,a=Nn(n,i)),"name"in c&&t(0,l=c.name),"color"in c&&t(1,h=c.color),"size"in c&&t(2,s=c.size),"strokeWidth"in c&&t(3,f=c.strokeWidth),"absoluteStrokeWidth"in c&&t(4,w=c.absoluteStrokeWidth),"iconNode"in c&&t(5,_=c.iconNode),"$$scope"in c&&t(8,o=c.$$scope)},n=Le(n),[l,h,s,f,w,_,a,n,o,r]}class Xa extends dt{constructor(n){super(),ut(this,n,xs,ks,Pe,{name:0,color:1,size:2,strokeWidth:3,absoluteStrokeWidth:4,iconNode:5})}}function ys(e){let n;const t=e[2].default,i=Ct(t,e,e[3],null);return{c(){i&&i.c()},l(a){i&&i.l(a)},m(a,r){i&&i.m(a,r),n=!0},p(a,r){i&&i.p&&(!n||r&8)&&Nt(i,t,a,a[3],n?Ut(t,a[3],r,null):Mt(a[3]),null)},i(a){n||(q(i,a),n=!0)},o(a){ae(i,a),n=!1},d(a){i&&i.d(a)}}}function Es(e){let n,t;const i=[{name:"info"},e[1],{iconNode:e[0]}];let a={$$slots:{default:[ys]},$$scope:{ctx:e}};for(let r=0;r<i.length;r+=1)a=_e(a,i[r]);return n=new Xa({props:a}),{c(){et(n.$$.fragment)},l(r){tt(n.$$.fragment,r)},m(r,o){nt(n,r,o),t=!0},p(r,[o]){const l=o&3?Lt(i,[i[0],o&2&&Ki(r[1]),o&1&&{iconNode:r[0]}]):{};o&8&&(l.$$scope={dirty:o,ctx:r}),n.$set(l)},i(r){t||(q(n.$$.fragment,r),t=!0)},o(r){ae(n.$$.fragment,r),t=!1},d(r){it(n,r)}}}function As(e,n,t){let{$$slots:i={},$$scope:a}=n;const r=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 16v-4"}],["path",{d:"M12 8h.01"}]];return e.$$set=o=>{t(1,n=_e(_e({},n),Le(o))),"$$scope"in o&&t(3,a=o.$$scope)},n=Le(n),[r,n,i,a]}class Ss extends dt{constructor(n){super(),ut(this,n,As,Es,Pe,{})}}function Ts(e){let n;const t=e[2].default,i=Ct(t,e,e[3],null);return{c(){i&&i.c()},l(a){i&&i.l(a)},m(a,r){i&&i.m(a,r),n=!0},p(a,r){i&&i.p&&(!n||r&8)&&Nt(i,t,a,a[3],n?Ut(t,a[3],r,null):Mt(a[3]),null)},i(a){n||(q(i,a),n=!0)},o(a){ae(i,a),n=!1},d(a){i&&i.d(a)}}}function zs(e){let n,t;const i=[{name:"x"},e[1],{iconNode:e[0]}];let a={$$slots:{default:[Ts]},$$scope:{ctx:e}};for(let r=0;r<i.length;r+=1)a=_e(a,i[r]);return n=new Xa({props:a}),{c(){et(n.$$.fragment)},l(r){tt(n.$$.fragment,r)},m(r,o){nt(n,r,o),t=!0},p(r,[o]){const l=o&3?Lt(i,[i[0],o&2&&Ki(r[1]),o&1&&{iconNode:r[0]}]):{};o&8&&(l.$$scope={dirty:o,ctx:r}),n.$set(l)},i(r){t||(q(n.$$.fragment,r),t=!0)},o(r){ae(n.$$.fragment,r),t=!1},d(r){it(n,r)}}}function Ds(e,n,t){let{$$slots:i={},$$scope:a}=n;const r=[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]];return e.$$set=o=>{t(1,n=_e(_e({},n),Le(o))),"$$scope"in o&&t(3,a=o.$$scope)},n=Le(n),[r,n,i,a]}class Rs extends dt{constructor(n){super(),ut(this,n,Ds,zs,Pe,{})}}function Ni(e){let n,t,i,a,r,o,l,h,s,f,w,_,c=e[2]&&Mi(e),d=e[2]&&Ui(e);const k=e[4].default,g=Ct(k,e,e[3],null);return{c(){n=U("div"),t=U("div"),i=U("div"),c&&c.c(),a=j(),r=U("div"),o=U("div"),l=U("span"),h=te(e[1]),s=j(),d&&d.c(),f=j(),w=U("div"),g&&g.c(),this.h()},l(b){n=L(b,"DIV",{class:!0});var x=F(n);t=L(x,"DIV",{class:!0});var y=F(t);i=L(y,"DIV",{class:!0});var u=F(i);c&&c.l(u),u.forEach(S),a=V(y),r=L(y,"DIV",{class:!0});var m=F(r);o=L(m,"DIV",{class:!0});var Z=F(o);l=L(Z,"SPAN",{});var v=F(l);h=ne(v,e[1]),v.forEach(S),s=V(Z),d&&d.l(Z),Z.forEach(S),f=V(m),w=L(m,"DIV",{class:!0});var R=F(w);g&&g.l(R),R.forEach(S),m.forEach(S),y.forEach(S),x.forEach(S),this.h()},h(){H(i,"class","absolute top-0 left-0 w-full h-full bg-black bg-opacity-50"),H(o,"class","border-zinc-800 border-b-2 px-2 py-1 text-white font-semibold flex justify-between items-center gap-4"),H(w,"class","px-2 py-1"),H(r,"class","z-20 border-zinc-800 border-2 bg-zinc-900"),H(t,"class","relative w-full h-full flex justify-center items-center"),H(n,"class","z-50 fixed top-0 left-0 w-screen h-screen")},m(b,x){X(b,n,x),z(n,t),z(t,i),c&&c.m(i,null),z(t,a),z(t,r),z(r,o),z(o,l),z(l,h),z(o,s),d&&d.m(o,null),z(r,f),z(r,w),g&&g.m(w,null),_=!0},p(b,x){b[2]?c?c.p(b,x):(c=Mi(b),c.c(),c.m(i,null)):c&&(c.d(1),c=null),(!_||x&2)&&ge(h,b[1]),b[2]?d?(d.p(b,x),x&4&&q(d,1)):(d=Ui(b),d.c(),q(d,1),d.m(o,null)):d&&(Xi(),ae(d,1,1,()=>{d=null}),Yi()),g&&g.p&&(!_||x&8)&&Nt(g,k,b,b[3],_?Ut(k,b[3],x,null):Mt(b[3]),null)},i(b){_||(q(d),q(g,b),_=!0)},o(b){ae(d),ae(g,b),_=!1},d(b){b&&S(n),c&&c.d(),d&&d.d(),g&&g.d(b)}}}function Mi(e){let n,t,i,a;return{c(){n=U("button"),this.h()},l(r){n=L(r,"BUTTON",{class:!0,title:!0}),F(n).forEach(S),this.h()},h(){H(n,"class","absolute top-0 left-0 w-full h-full"),H(n,"title",t="Close "+e[1])},m(r,o){X(r,n,o),i||(a=oe(n,"click",e[5]),i=!0)},p(r,o){o&2&&t!==(t="Close "+r[1])&&H(n,"title",t)},d(r){r&&S(n),i=!1,a()}}}function Ui(e){let n,t,i,a,r,o;return t=new Rs({}),{c(){n=U("button"),et(t.$$.fragment),this.h()},l(l){n=L(l,"BUTTON",{class:!0,title:!0});var h=F(n);tt(t.$$.fragment,h),h.forEach(S),this.h()},h(){H(n,"class","float-right"),H(n,"title",i="Close "+e[1])},m(l,h){X(l,n,h),nt(t,n,null),a=!0,r||(o=oe(n,"click",e[6]),r=!0)},p(l,h){(!a||h&2&&i!==(i="Close "+l[1]))&&H(n,"title",i)},i(l){a||(q(t.$$.fragment,l),a=!0)},o(l){ae(t.$$.fragment,l),a=!1},d(l){l&&S(n),it(t),r=!1,o()}}}function Zs(e){let n,t,i=e[0]&&Ni(e);return{c(){i&&i.c(),n=Oe()},l(a){i&&i.l(a),n=Oe()},m(a,r){i&&i.m(a,r),X(a,n,r),t=!0},p(a,[r]){a[0]?i?(i.p(a,r),r&1&&q(i,1)):(i=Ni(a),i.c(),q(i,1),i.m(n.parentNode,n)):i&&(Xi(),ae(i,1,1,()=>{i=null}),Yi())},i(a){t||(q(i),t=!0)},o(a){ae(i),t=!1},d(a){a&&S(n),i&&i.d(a)}}}function Is(e,n,t){let{$$slots:i={},$$scope:a}=n,{visible:r=!1}=n,{title:o}=n,{closable:l=!0}=n;const h=()=>t(0,r=!1),s=()=>t(0,r=!1);return e.$$set=f=>{"visible"in f&&t(0,r=f.visible),"title"in f&&t(1,o=f.title),"closable"in f&&t(2,l=f.closable),"$$scope"in f&&t(3,a=f.$$scope)},[r,o,l,a,i,h,s]}class Cs extends dt{constructor(n){super(),ut(this,n,Is,Zs,Pe,{visible:0,title:1,closable:2})}}function Li(e){let n,t,i=e[0].seed+"",a,r,o;return{c(){n=U("span"),t=te("Seed: "),a=te(i),r=j(),o=U("br")},l(l){n=L(l,"SPAN",{});var h=F(n);t=ne(h,"Seed: "),a=ne(h,i),r=V(h),h.forEach(S),o=L(l,"BR",{})},m(l,h){X(l,n,h),z(n,t),z(n,a),z(n,r),X(l,o,h)},p(l,h){h&1&&i!==(i=l[0].seed+"")&&ge(a,i)},d(l){l&&(S(n),S(o))}}}function Oi(e){let n,t,i=e[7].x+"",a,r,o=e[7].y+"",l,h,s,f,w,_,c=Math.floor(e[7].x/Y)+"",d,k,g=Math.floor(e[7].y/Y)+"",b,x,y;return{c(){n=U("span"),t=te("Tile: "),a=te(i),r=j(),l=te(o),h=j(),s=U("br"),f=j(),w=U("span"),_=te("Chunk: "),d=te(c),k=j(),b=te(g),x=j(),y=U("br")},l(u){n=L(u,"SPAN",{});var m=F(n);t=ne(m,"Tile: "),a=ne(m,i),r=V(m),l=ne(m,o),m.forEach(S),h=V(u),s=L(u,"BR",{}),f=V(u),w=L(u,"SPAN",{});var Z=F(w);_=ne(Z,"Chunk: "),d=ne(Z,c),k=V(Z),b=ne(Z,g),Z.forEach(S),x=V(u),y=L(u,"BR",{})},m(u,m){X(u,n,m),z(n,t),z(n,a),z(n,r),z(n,l),X(u,h,m),X(u,s,m),X(u,f,m),X(u,w,m),z(w,_),z(w,d),z(w,k),z(w,b),X(u,x,m),X(u,y,m)},p(u,m){m&128&&i!==(i=u[7].x+"")&&ge(a,i),m&128&&o!==(o=u[7].y+"")&&ge(l,o),m&128&&c!==(c=Math.floor(u[7].x/Y)+"")&&ge(d,c),m&128&&g!==(g=Math.floor(u[7].y/Y)+"")&&ge(b,g)},d(u){u&&(S(n),S(h),S(s),S(f),S(w),S(x),S(y))}}}function Bi(e){let n=Math.round(e[6]*10)/10+"",t,i;return{c(){t=te(n),i=te("ms")},l(a){t=ne(a,n),i=ne(a,"ms")},m(a,r){X(a,t,r),X(a,i,r)},p(a,r){r&64&&n!==(n=Math.round(a[6]*10)/10+"")&&ge(t,n)},d(a){a&&(S(t),S(i))}}}function Ns(e){let n,t=`<h1 class="text-2xl"><a href="https://vulae.github.io/infinite-minesweeper">Infinite Minesweeper</a></h1> <h2 class="text-xl">CONTROLS</h2>
        Left Click: Reveal tile
        <br/>
        Right Click: Flag tile
        <br/>
        Middle Click / Arrow Keys: Move view
        <br/>
        Scroll Wheel: Zoom view
        <br/>
        Open Bracket &#39;[&#39;: Zoom In
        <br/>
        Close Bracket &#39;]&#39;: Zoom Out
        <br/>`;return{c(){n=U("span"),n.innerHTML=t,this.h()},l(i){n=L(i,"SPAN",{class:!0,"data-svelte-h":!0}),tr(n)!=="svelte-s5h82y"&&(n.innerHTML=t),this.h()},h(){H(n,"class","text-white font-semibold font-segoe")},m(i,a){X(i,n,a)},p:Ja,d(i){i&&S(n)}}}function Ms(e){let n,t,i,a,r,o,l,h,s,f,w,_,c,d,k,g,b,x,y,u,m,Z,v,R,T;s=new Ss({props:{size:32,strokeWidth:3}});let p=e[0]&&Li(e),E=e[7]&&Oi(e),M=e[6]!==null&&Bi(e);function A(D){e[21](D)}let P={title:"Information",$$slots:{default:[Ns]},$$scope:{ctx:e}};return e[8]!==void 0&&(P.visible=e[8]),m=new Cs({props:P}),Fi.push(()=>er(m,"visible",A)),{c(){n=U("div"),t=U("canvas"),a=j(),r=U("div"),o=U("div"),l=U("div"),h=U("button"),et(s.$$.fragment),f=j(),w=U("div"),_=U("div"),c=U("div"),p&&p.c(),d=j(),E&&E.c(),k=j(),g=U("span"),b=te("Frame "),x=te(e[5]),y=j(),M&&M.c(),u=j(),et(m.$$.fragment),this.h()},l(D){n=L(D,"DIV",{class:!0});var G=F(n);t=L(G,"CANVAS",{class:!0}),F(t).forEach(S),a=V(G),r=L(G,"DIV",{class:!0});var Ze=F(r);o=L(Ze,"DIV",{class:!0});var pt=F(o);l=L(pt,"DIV",{class:!0});var Rn=F(l);h=L(Rn,"BUTTON",{class:!0});var Zn=F(h);tt(s.$$.fragment,Zn),Zn.forEach(S),Rn.forEach(S),f=V(pt),w=L(pt,"DIV",{class:!0});var In=F(w);_=L(In,"DIV",{class:!0});var Cn=F(_);c=L(Cn,"DIV",{class:!0});var Ie=F(c);p&&p.l(Ie),d=V(Ie),E&&E.l(Ie),k=V(Ie),g=L(Ie,"SPAN",{});var Ge=F(g);b=ne(Ge,"Frame "),x=ne(Ge,e[5]),y=V(Ge),M&&M.l(Ge),Ge.forEach(S),Ie.forEach(S),Cn.forEach(S),In.forEach(S),pt.forEach(S),Ze.forEach(S),G.forEach(S),u=V(D),tt(m.$$.fragment,D),this.h()},h(){H(t,"class","w-full h-full col-start-1 col-end-1 row-start-1 row-end-1"),H(h,"class","text-blue-500 bg-zinc-800 outline outline-black outline-1 rounded-full w-min flex items-center justify-center"),H(l,"class","pointer-events-auto p-4"),H(c,"class","text-white font-bold"),H(_,"class","p-4 bg-zinc-800 bg-opacity-70 outline outline-zinc-600 rounded-lg"),H(w,"class","pointer-events-auto p-4"),H(o,"class","w-full h-full flex justify-between"),H(r,"class","w-full h-full col-start-1 col-end-1 row-start-1 row-end-1 pointer-events-none"),H(n,"class","w-screen h-screen grid grid-cols-1 grid-rows-1")},m(D,G){X(D,n,G),z(n,t),e[14](t),z(n,a),z(n,r),z(r,o),z(o,l),z(l,h),nt(s,h,null),z(o,f),z(o,w),z(w,_),z(_,c),p&&p.m(c,null),z(c,d),E&&E.m(c,null),z(c,k),z(c,g),z(g,b),z(g,x),z(g,y),M&&M.m(g,null),X(D,u,G),nt(m,D,G),v=!0,R||(T=[oe(window,"keydown",e[11]),oe(window,"keyup",e[12]),oe(window,"unload",e[13]),Ga(i=ps.call(null,t,e[15])),oe(t,"mousedown",e[16]),oe(t,"mouseup",e[17]),oe(t,"mousemove",e[18]),oe(t,"wheel",e[19],{passive:!0}),oe(t,"contextmenu",Us),oe(h,"click",e[20])],R=!0)},p(D,[G]){i&&Wa(i.update)&&G&158&&i.update.call(null,D[15]),D[0]?p?p.p(D,G):(p=Li(D),p.c(),p.m(c,d)):p&&(p.d(1),p=null),D[7]?E?E.p(D,G):(E=Oi(D),E.c(),E.m(c,k)):E&&(E.d(1),E=null),(!v||G&32)&&ge(x,D[5]),D[6]!==null?M?M.p(D,G):(M=Bi(D),M.c(),M.m(g,null)):M&&(M.d(1),M=null);const Ze={};G&67108864&&(Ze.$$scope={dirty:G,ctx:D}),!Z&&G&256&&(Z=!0,Ze.visible=D[8],$a(()=>Z=!1)),m.$set(Ze)},i(D){v||(q(s.$$.fragment,D),q(m.$$.fragment,D),v=!0)},o(D){ae(s.$$.fragment,D),ae(m.$$.fragment,D),v=!1},d(D){D&&(S(n),S(u)),e[14](null),it(s),p&&p.d(),E&&E.d(),M&&M.d(),it(m,D),R=!1,ja(T)}}}const Us=e=>{e.preventDefault()};function Ls(e,n,t){let i,a=!0,r,o;function l(){const A=localStorage.getItem("save");if(A){console.log("Loaded saved world");const P=JSON.parse(A);t(0,r=It.load(P))}else{console.log("Loaded new world"),localStorage.setItem("save","PLACEHOLDER"),t(0,r=new It(Math.floor(Math.random()*4294967295)));const P=r.closest0(0,0);r.reveal(P.x,P.y)}t(3,o=new nr(r,i)),t(2,a=!0)}function h(){localStorage.getItem("save")!==null&&(console.log("Save world"),localStorage.setItem("save",JSON.stringify(r.save())))}let s=!1,f=-1,w=0,_=null;const c=()=>{if(cancelAnimationFrame(f),f=requestAnimationFrame(c),s){t(4,s=!1),t(5,w++,w);const A=performance.now();o.render(),t(6,_=performance.now()-A)}};let d=null,k=new Set,g=-1;Va(()=>{l(),O.onLoad(()=>{t(4,s=!0)}),clearInterval(g),g=setInterval(()=>{let A=!1;k.has("[")&&(o.cameraScale(1.04),t(7,d=null),A=!0),k.has("]")&&(o.cameraScale(.96),t(7,d=null),A=!0),k.has("ArrowUp")&&(o.cameraTranslate(0,10),A=!0),k.has("ArrowDown")&&(o.cameraTranslate(0,-10),A=!0),k.has("ArrowLeft")&&(o.cameraTranslate(10,0),A=!0),k.has("ArrowRight")&&(o.cameraTranslate(-10,0),A=!0),A&&t(4,s=!0)},1e3/60),c()}),qa(()=>{cancelAnimationFrame(f),clearInterval(g),h()});let b=!0;const x=A=>{k.add(A.key)},y=A=>{k.delete(A.key)},u=()=>{h()};function m(A){Fi[A?"unshift":"push"](()=>{i=A,t(1,i)})}const Z=(A,P)=>{t(1,i.width=A,i),t(1,i.height=P,i),o.cameraScale(1),t(7,d=null),a&&(o.cameraTranslate(i.width/2,i.height/2),t(2,a=!1)),t(4,s=!0)},v=A=>{if(document.pointerLockElement!=i){if(A.button==1)i.requestPointerLock(),A.preventDefault();else if(A.button==0){A.preventDefault();const P=o.cameraPos(A.offsetX,A.offsetY);r.reveal(P.x,P.y),t(4,s=!0)}else if(A.button==2){A.preventDefault();const P=o.cameraPos(A.offsetX,A.offsetY);r.flag(P.x,P.y),t(4,s=!0)}}},R=A=>{document.pointerLockElement==i&&A.button==1&&document.exitPointerLock()},T=A=>{t(7,d=o.cameraPos(A.offsetX,A.offsetY)),document.pointerLockElement==i&&(o.cameraTranslate(A.movementX,A.movementY),t(4,s=!0))},p=A=>{const P=A.deltaY>0?.9:1.1;o.cameraZoom!=o.cameraScale(P)&&(t(7,d=o.cameraPos(A.offsetX,A.offsetY)),t(4,s=!0))},E=()=>t(8,b=!0);function M(A){b=A,t(8,b)}return e.$$.update=()=>{e.$$.dirty&1&&r&&console.log(r)},[r,i,a,o,s,w,_,d,b,h,k,x,y,u,m,Z,v,R,T,p,E,M]}class Ps extends dt{constructor(n){super(),ut(this,n,Ls,Ms,Pe,{})}}export{Ps as component};
